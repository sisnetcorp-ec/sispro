<?php
/* CbPlus */
/*

*/
 namespace MincDev\OtpAuth; class FixedBitNotation { protected $_chars; protected $_bitsPerCharacter; protected $_radix; protected $_rightPadFinalBits; protected $_padFinalGroup; protected $_padCharacter; protected $_charmap; public function __construct($bitsPerCharacter, $chars = NULL, $rightPadFinalBits = FALSE, $padFinalGroup = FALSE, $padCharacter = "\x3d") { goto m_ELIDCXSUd_; aK_7FBAeflM8: $this->_padFinalGroup = $padFinalGroup; goto Mj061QZnpg3n; HEOwG6M8_cMv: goto ZYm_czBkqMWX; goto t6sPula3gKrK; sQooaMY6bxL7: goto ZYm_czBkqMWX; goto nm56Dm1GEqxY; CA2BiQwTaACB: $this->_radix = $radix; goto Wqa2mSOcgVLL; FJgX9ELCywKs: $radix = 256; goto FuLJQxrWIyZ9; nm56Dm1GEqxY: t13OJOETv1sL: goto ic9xPkY_ac0i; vlDeJXZq_H0B: $bitsPerCharacter = 1; goto HE90YLO5A1Iw; Tr41op51JFXP: $this->_bitsPerCharacter = $bitsPerCharacter; goto CA2BiQwTaACB; C0ISyVhdav4l: if ($bitsPerCharacter < 1) { goto X_fbB9wfFfkn; } goto TxmLvu8fG3yq; gjK9QqlcIGMq: X_fbB9wfFfkn: goto vlDeJXZq_H0B; Mj061QZnpg3n: $this->_padCharacter = $padCharacter[0]; goto ar8dmioYlHq8; xGT32Ts_ynQz: ONnhhaQZtWrQ: goto Z07KDChgQ94P; O5MYUGysWDKh: if (!($charLength >= ($radix <<= 1) && $bitsPerCharacter < 8)) { goto ONnhhaQZtWrQ; } goto qrivnhWLXrkq; UjEX2yKBEXEc: $radix = 1 << $bitsPerCharacter; goto uUX_lWLb05ka; uUX_lWLb05ka: goto ZYm_czBkqMWX; goto gjK9QqlcIGMq; SKaQet4GRaK5: IxqZ08ofEGNZ: goto C0ISyVhdav4l; ic9xPkY_ac0i: $bitsPerCharacter = 1; goto Y6A6BqsUt7SB; mR3eVUasLi8Y: goto dOlPPfZSFKZm; goto xGT32Ts_ynQz; iR3ZyeV3Fq93: $chars = "\x30\x31\x32\63\64\65\66\67\x38\x39\141\142\143\x64\145\146\x67\150\151\152\153\x6c\155\156\157\160\x71\x72\163\x74\x75\166\x77\170\x79\172\101\x42\x43\x44\105\106\x47\110\x49\112\113\x4c\x4d\x4e\117\120\121\x52\123\x54\125\x56\127\x58\131\x5a\55\x2c"; goto rzT_VD4h4Rt2; qrivnhWLXrkq: $bitsPerCharacter++; goto mR3eVUasLi8Y; rzT_VD4h4Rt2: $charLength = 64; goto SKaQet4GRaK5; I4tPzz0gUFcE: $bitsPerCharacter = 8; goto FJgX9ELCywKs; HE90YLO5A1Iw: $radix = 2; goto sQooaMY6bxL7; pg9I4iZpwLYd: $this->_chars = $chars; goto Tr41op51JFXP; m_ELIDCXSUd_: if (!(!is_string($chars) || ($charLength = strlen($chars)) < 2)) { goto IxqZ08ofEGNZ; } goto iR3ZyeV3Fq93; TxmLvu8fG3yq: if ($charLength < 1 << $bitsPerCharacter) { goto t13OJOETv1sL; } goto SyIchjKgHJsZ; Wqa2mSOcgVLL: $this->_rightPadFinalBits = $rightPadFinalBits; goto aK_7FBAeflM8; Y6A6BqsUt7SB: $radix = 2; goto wTqf4gdh4hh0; Z07KDChgQ94P: $radix >>= 1; goto HEOwG6M8_cMv; t6sPula3gKrK: dgi8CA0WuP1Y: goto I4tPzz0gUFcE; FuLJQxrWIyZ9: ZYm_czBkqMWX: goto pg9I4iZpwLYd; SyIchjKgHJsZ: if ($bitsPerCharacter > 8) { goto dgi8CA0WuP1Y; } goto UjEX2yKBEXEc; wTqf4gdh4hh0: dOlPPfZSFKZm: goto O5MYUGysWDKh; ar8dmioYlHq8: } public function encode($rawString) { goto eJO3gJRZT1XI; mKLoOKhHDgzs: $bitsRead += $newBitCount; goto FFDCLHj9mYiA; ORVok20wojtb: VLQZZPl2_BnY: goto yuTv45k3ztUO; B0i5fqk1b0HX: $pads = $bytesPerGroup * 8 / $bitsPerCharacter - ceil(strlen($rawString) % $bytesPerGroup * 8 / $bitsPerCharacter); goto sPvEE1rf1AGO; d7wSLaypM_Yp: if (!$padFinalGroup) { goto Nb6lcv132qg3; } goto HTVtS4cqNkgm; QGcD8QMjVWDw: goto i_p2uSWjEQVv; goto MMEMlCnZjY10; OJ2bIEGlNXOU: $bitsRead = 0; goto PM271Jj2Ho1e; ivxdh9P453v5: $newBitCount = $bitsPerCharacter; goto QGcD8QMjVWDw; UUMEbJn5U0D1: goto JrD3bLOR9bPy; goto ORVok20wojtb; HT5JyKwGOO_6: xM1CEnRb0SGC: goto IgSX52tpto7u; PM271Jj2Ho1e: i_p2uSWjEQVv: goto txXZLsonO2MG; gT1Twndlr4LZ: $oldBits <<= $newBitCount; goto HT5JyKwGOO_6; K6dQJ12UQlbb: $c++; goto KJXtLn6ll1uW; sPvEE1rf1AGO: $encodedString .= str_repeat($padCharacter[0], $pads); goto NAbN08nNnKXp; iQOGQbUq7Roh: $bits ^= $bits >> $newBitCount << $newBitCount; goto mKLoOKhHDgzs; SksKbCRnY9e5: $c = 0; goto zZj2Pp5P2RCW; txXZLsonO2MG: $bits = $byte >> 8 - ($bitsRead + $newBitCount); goto iQOGQbUq7Roh; TNdTRhWiBkxP: Y_69vepQcr35: goto k26Aq0LyL8qa; yuTv45k3ztUO: $byte = array_shift($bytes); goto OJ2bIEGlNXOU; m5MX0xVhcpQ8: $bytesPerGroup = $lcmMap[$bitsPerCharacter]; goto B0i5fqk1b0HX; XY1xXenFXFTZ: $encodedString = ''; goto qAA8C8YLwYka; cSLHaTwTt8Cz: return $encodedString; goto PNqHPOxzDSMu; qAA8C8YLwYka: $byte = array_shift($bytes); goto oEGmDBXSHodw; KJXtLn6ll1uW: goto Hlr6otfCzwEk; goto sp3geIA91NjK; kA4rojrfMn7Z: $byteCount = count($bytes); goto XY1xXenFXFTZ; FFDCLHj9mYiA: if (!$oldBitCount) { goto Y_69vepQcr35; } goto xQj0NjgHlKT4; CdlOb5AsX0eK: $newBitCount = $bitsPerCharacter - $oldBitCount; goto ybPvQ1oHQAlg; HTVtS4cqNkgm: $lcmMap = array(1 => 1, 2 => 1, 3 => 3, 4 => 1, 5 => 5, 6 => 3, 7 => 7, 8 => 1); goto m5MX0xVhcpQ8; phYjASkuwj5M: $oldBitCount = 0; goto ivxdh9P453v5; o8z7afeOSr4r: $padCharacter = $this->_padCharacter; goto SksKbCRnY9e5; cnw0uePzqryY: $padFinalGroup = $this->_padFinalGroup; goto o8z7afeOSr4r; NAbN08nNnKXp: Nb6lcv132qg3: goto UUMEbJn5U0D1; etozmD_I5Oo9: if ($bitsRead + $bitsPerCharacter > 8) { goto jK60_1R12hnS; } goto phYjASkuwj5M; oEGmDBXSHodw: $bitsRead = 0; goto En53e2D4bBLM; MMEMlCnZjY10: jK60_1R12hnS: goto s8sy1G74wFIP; ybPvQ1oHQAlg: if ($bytes) { goto VLQZZPl2_BnY; } goto D6OMU331LGo_; s8sy1G74wFIP: $oldBitCount = 8 - $bitsRead; goto pc7MtaHvQ8iR; mvEhAmM_jImY: $rightPadFinalBits = $this->_rightPadFinalBits; goto cnw0uePzqryY; BvAV6UgRSuT4: IPg9ixm4igdj: goto K6dQJ12UQlbb; xQj0NjgHlKT4: $bits = $oldBits << $newBitCount | $bits; goto TNdTRhWiBkxP; eJO3gJRZT1XI: $bytes = unpack("\103\52", $rawString); goto kA4rojrfMn7Z; En53e2D4bBLM: $chars = $this->_chars; goto K9W92Jbs1Wn6; k26Aq0LyL8qa: $encodedString .= $chars[$bits]; goto BvAV6UgRSuT4; zZj2Pp5P2RCW: Hlr6otfCzwEk: goto XYfN1XzRxk5X; XYfN1XzRxk5X: if (!($c < $byteCount * 8 / $bitsPerCharacter)) { goto JrD3bLOR9bPy; } goto etozmD_I5Oo9; D6OMU331LGo_: if (!$rightPadFinalBits) { goto xM1CEnRb0SGC; } goto gT1Twndlr4LZ; IgSX52tpto7u: $encodedString .= $chars[$oldBits]; goto d7wSLaypM_Yp; K9W92Jbs1Wn6: $bitsPerCharacter = $this->_bitsPerCharacter; goto mvEhAmM_jImY; sp3geIA91NjK: JrD3bLOR9bPy: goto cSLHaTwTt8Cz; pc7MtaHvQ8iR: $oldBits = $byte ^ $byte >> $oldBitCount << $oldBitCount; goto CdlOb5AsX0eK; PNqHPOxzDSMu: } public function decode($encodedString, $caseSensitive = TRUE, $strict = FALSE) { goto iKAohhWix7ye; uJ2XBJDtjpCA: $radix = $this->_radix; goto NJns3SsDfyN3; Wi_euZvhGKrc: $charmap[$encodedString[$c]] = $charmap[$cLower]; goto U93X_AjtPwxd; IHr8X02BLQqg: $i = 0; goto ESL3G4XAVgJ3; U93X_AjtPwxd: yUmQxTs_YNY1: goto CmLyqh1I9IhX; W3JYwlbNJSaM: goto MQXu6KeNqYII; goto vAGKUp_OzwUk; Jp29ujCIN99g: goto kinBjuEtiddS; goto VHUmjjkm5u8O; V8m3osPpf8XX: if ($this->_charmap) { goto PGFXGe1lgxYu; } goto gL5HHZPMtcu6; VzDayR_pzIbk: if (isset($charmap[$encodedString[$c]])) { goto Vx9DY87mF2VS; } goto nWWx0r49kMjq; LfBull65SXwW: if (!($encodedString[$lastNotatedIndex] == $padCharacter[0])) { goto tKuq8tFh3bhT; } goto e11P7uBIUQTR; HThU2CBc4k_L: rMDgTNsHZqmX: goto VOlPWKqfyS4N; T47BEf6mfyD2: ZsUwOtUsk9j6: goto CsOBhdftV7cp; bxB8kuuLEeBr: $charmap = $this->_charmap; goto RqDfo9S5h5qk; gIAZPHwZxmP3: goto mDQEaOnfhJn0; goto oQIsISx6R1bY; VW_YYg3SjCeQ: $newBits = $charmap[$encodedString[$c]] >> $unusedBitCount; goto U34TJGJIQcCO; XkqNjFso8w4D: pB54xB0rkPbM: goto G1l58WoJ_jxl; CsOBhdftV7cp: if (!($c <= $lastNotatedIndex)) { goto FjcF0OqWHU0y; } goto D6KEv0dcwqmw; Iwd63uZsht_g: $byte = ($charmap[$encodedString[$c]] ^ $newBits << $unusedBitCount) << 8 - $bitsWritten; goto EGqda2CPCaFT; Ihu3LirjNnpv: goto yUmQxTs_YNY1; goto h7LTaakOKWdA; kJHMwRYaSZgw: p5tFdRi0le04: goto Lcwd0lhAsYFX; A7TF41gwbgwM: return $rawString; goto aJsNvmQxeUju; t4zsYhvNXN3b: return ''; goto xkBwQ9jxAjbi; d9gTuPz4xVxl: $rawString .= pack("\103", $byte); goto pfQUg0ZdRt7c; gL5HHZPMtcu6: $charmap = array(); goto IHr8X02BLQqg; Lcwd0lhAsYFX: $charmap[$encodedString[$c]] = $charmap[$cUpper]; goto Ihu3LirjNnpv; Hz1nVcoZ3xFs: $padFinalGroup = $this->_padFinalGroup; goto rvj1caVoc00j; UUJCr46yUMgb: $c = 0; goto T47BEf6mfyD2; LNq5sZIEruFb: goto kinBjuEtiddS; goto pe6neDlEK0E_; pDai92Fwievk: goto dzTufmrROz36; goto jX8NjtOnqn8Z; ESL3G4XAVgJ3: DBjKeQRDdsFB: goto SP1NsHjt5gEh; sRR0xTj7e5lL: $byte = 0; goto bBw1MbqPQgek; aMg6TSYlHdRu: Vx9DY87mF2VS: goto lnaPHOKXCR2f; NJns3SsDfyN3: $rightPadFinalBits = $this->_rightPadFinalBits; goto Hz1nVcoZ3xFs; EGqda2CPCaFT: tvVYu_WJXXBE: goto SLROp1ZiTrN6; G1l58WoJ_jxl: $this->_charmap = $charmap; goto gIAZPHwZxmP3; rvj1caVoc00j: $padCharacter = $this->_padCharacter; goto V8m3osPpf8XX; RqDfo9S5h5qk: mDQEaOnfhJn0: goto pw3P2WZusBQ_; yYdpeo8Fe_ft: $charmap[$chars[$i]] = $i; goto VzFCJM7j7L28; lnaPHOKXCR2f: $bitsNeeded = 8 - $bitsWritten; goto cDg69OgUoDvo; Y80NBmMjn4yT: goto DBjKeQRDdsFB; goto XkqNjFso8w4D; pfQUg0ZdRt7c: if (!($c != $lastNotatedIndex)) { goto tvVYu_WJXXBE; } goto RpkWJKxwqhzX; nWWx0r49kMjq: if ($strict) { goto HBVUvBsu9rCL; } goto WRR1V98YWSX9; R0RpC12FgSb2: if ($c != $lastNotatedIndex || $rightPadFinalBits) { goto TDf_rXU_Jgjs; } goto P9vZNN3dHNUg; VHUmjjkm5u8O: edE8wdQqVmxr: goto FETjVe3E8Mtq; bBw1MbqPQgek: $bitsWritten = 0; goto UUJCr46yUMgb; T_JHUSAyAEf1: dzTufmrROz36: goto HThU2CBc4k_L; h7LTaakOKWdA: VpYAgITsSFYb: goto Wi_euZvhGKrc; cDg69OgUoDvo: $unusedBitCount = $bitsPerCharacter - $bitsNeeded; goto pcNyDcYjAcJG; RpkWJKxwqhzX: $bitsWritten = $unusedBitCount; goto Iwd63uZsht_g; P9vZNN3dHNUg: $newBits = $charmap[$encodedString[$c]]; goto wxUNwMtkR58s; uCEV2fu8QOSY: goto ZsUwOtUsk9j6; goto xleInMzwXr9P; tLZTse36m7WQ: $byte |= $newBits; goto CCnwg9UzHxZr; xleInMzwXr9P: FjcF0OqWHU0y: goto A7TF41gwbgwM; VOlPWKqfyS4N: $c++; goto uCEV2fu8QOSY; AtXk7gAtqFx9: $bitsPerCharacter = $this->_bitsPerCharacter; goto uJ2XBJDtjpCA; iKAohhWix7ye: if (!(!$encodedString || !is_string($encodedString))) { goto mbZujte3lpTC; } goto t4zsYhvNXN3b; a38VBg5xYSCN: if (isset($charmap[$cUpper = strtoupper($encodedString[$c])])) { goto p5tFdRi0le04; } goto zGyn_frI0zUJ; XklhTdZcYQ1u: $rawString = ''; goto sRR0xTj7e5lL; a73kL8qhK16P: goto yUmQxTs_YNY1; goto kJHMwRYaSZgw; FETjVe3E8Mtq: $newBits = $charmap[$encodedString[$c]] << $bitsNeeded - $bitsPerCharacter; goto QQYh5xnaUujt; wreqaxBQJOM9: MQXu6KeNqYII: goto LfBull65SXwW; D6KEv0dcwqmw: if (!(!isset($charmap[$encodedString[$c]]) && !$caseSensitive)) { goto mi9lovRq001Z; } goto a38VBg5xYSCN; jX8NjtOnqn8Z: HBVUvBsu9rCL: goto F2eHrQnrqPRQ; F2eHrQnrqPRQ: return NULL; goto T_JHUSAyAEf1; WpuvnuwDF943: kinBjuEtiddS: goto tLZTse36m7WQ; CCnwg9UzHxZr: if (!($bitsWritten == 8 || $c == $lastNotatedIndex)) { goto Pmxxn00_gk3j; } goto d9gTuPz4xVxl; SLROp1ZiTrN6: Pmxxn00_gk3j: goto pDai92Fwievk; w8M5fn9J4Mc3: $i++; goto Y80NBmMjn4yT; oQIsISx6R1bY: PGFXGe1lgxYu: goto bxB8kuuLEeBr; WRR1V98YWSX9: goto dzTufmrROz36; goto aMg6TSYlHdRu; zWWGZQU_wth5: $lastNotatedIndex--; goto W3JYwlbNJSaM; e11P7uBIUQTR: $encodedString = substr($encodedString, 0, $lastNotatedIndex); goto zWWGZQU_wth5; QQYh5xnaUujt: $bitsWritten += $bitsPerCharacter; goto LNq5sZIEruFb; SP1NsHjt5gEh: if (!($i < $radix)) { goto pB54xB0rkPbM; } goto yYdpeo8Fe_ft; zGyn_frI0zUJ: if (isset($charmap[$cLower = strtolower($encodedString[$c])])) { goto VpYAgITsSFYb; } goto a73kL8qhK16P; vAGKUp_OzwUk: tKuq8tFh3bhT: goto XklhTdZcYQ1u; CmLyqh1I9IhX: mi9lovRq001Z: goto VzDayR_pzIbk; dIAR6sXL8Cyb: $chars = $this->_chars; goto AtXk7gAtqFx9; pe6neDlEK0E_: TDf_rXU_Jgjs: goto VW_YYg3SjCeQ; xkBwQ9jxAjbi: mbZujte3lpTC: goto dIAR6sXL8Cyb; U34TJGJIQcCO: $bitsWritten = 8; goto WpuvnuwDF943; wxUNwMtkR58s: $bitsWritten = 8; goto Jp29ujCIN99g; pw3P2WZusBQ_: $lastNotatedIndex = strlen($encodedString) - 1; goto wreqaxBQJOM9; pcNyDcYjAcJG: if ($bitsNeeded > $bitsPerCharacter) { goto edE8wdQqVmxr; } goto R0RpC12FgSb2; VzFCJM7j7L28: veonGVWh99Kv: goto w8M5fn9J4Mc3; aJsNvmQxeUju: } }
