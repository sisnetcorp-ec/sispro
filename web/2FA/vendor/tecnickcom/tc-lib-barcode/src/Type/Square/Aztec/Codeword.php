<?php
/* CbPlus */
/*

*/
 namespace Com\Tecnick\Barcode\Type\Square\Aztec; use Com\Tecnick\Barcode\Type\Square\Aztec\Data; use Com\Tecnick\Barcode\Exception as BarcodeException; abstract class Codeword { protected $encmode = Data::MODE_UPPER; protected $bitstream = array(); protected $tmpCdws = array(); protected $words = array(); protected $totbits = 0; protected function charEnc($mode, $ord) { return array_key_exists($ord, DATA::CHAR_ENC[$mode]) ? DATA::CHAR_ENC[$mode][$ord] : 0; } protected function charMode($ord) { return array_key_exists($ord, DATA::CHAR_MODES) ? DATA::CHAR_MODES[$ord] : Data::MODE_BINARY; } protected function isSameMode($mode, $ord) { return $mode == $this->charMode($ord) || $ord == 32 && $mode != Data::MODE_PUNCT || $mode == Data::MODE_PUNCT && ($ord == 13 || $ord == 44 || $ord == 46); } protected function isPunctAndDigitChar($ord) { return $ord == 32 || $ord == 44 || $ord == 46; } protected function punctPairMode($ord, $next) { goto YnHudRqQ38ps; YnHudRqQ38ps: $key = ($ord << 8) + $next; goto tuRdSP8IjeLY; tuRdSP8IjeLY: switch ($key) { case (13 << 8) + 10: return 2; case (46 << 8) + 32: return 3; case (44 << 8) + 32: return 4; case (58 << 8) + 32: return 5; } goto WM3kd2CvoJVL; WM3kd2CvoJVL: tV2HZGtsAPlo: goto tn_dVg1cXTfI; h34T8Qyu4n1X: return 0; goto gSoiSENmxgJJ; tn_dVg1cXTfI: H49g2m5nK3IL: goto h34T8Qyu4n1X; gSoiSENmxgJJ: } protected function appendWordToBitstream(array &$bitstream, &$totbits, $wsize, $value) { goto FLzCo7eNhkQd; UtmT_fQsIl0P: goto kguPlKslAFoK; goto sW_MgGiZcf96; xJDPCcgmBe35: $idx--; goto UtmT_fQsIl0P; w_u4LV23hhIY: HgXhzH5Gdb26: goto xJDPCcgmBe35; HN1irZVR4QLN: $bitstream[] = $value >> $idx & 1; goto w_u4LV23hhIY; sW_MgGiZcf96: e0UuF_I61O28: goto O75Cjc0_c_H3; FLzCo7eNhkQd: $idx = $wsize - 1; goto lin1JrvOTWM0; wrbWYJS_fy2R: if (!($idx >= 0)) { goto e0UuF_I61O28; } goto HN1irZVR4QLN; O75Cjc0_c_H3: $totbits += $wsize; goto ss2Bnm8t0pJa; lin1JrvOTWM0: kguPlKslAFoK: goto wrbWYJS_fy2R; ss2Bnm8t0pJa: } protected function bitstreamToWords(array $bitstream, $totbits, $wsize) { goto sVisZq1Fa3ex; RqUhLt9YiXHr: $pos = $idx * $wsize + $bit; goto far2r0CvN1bO; RwXhqNlMXHBo: $words[] = $wrd; goto HdX_V_KdJrjt; t3PU67NT_4tK: return $words; goto NyQS_w8gcNEd; sVisZq1Fa3ex: $words = array(); goto pa8CDGtUSihi; J9MuxvXjG7J5: hMKcKbvhZpw0: goto MOmy6Indhv_O; BeanOpMDIfH6: eDu2FNL0WcrB: goto kufaVuoKFZk0; EnuNIPrK2xqx: goto eDu2FNL0WcrB; goto ESBDcZ3k21px; fErZZaPidO1v: $wrd = 0; goto KwOTPtY2ETdR; ESBDcZ3k21px: jvzU6MkOnC_I: goto RwXhqNlMXHBo; kufaVuoKFZk0: if (!($bit < $wsize)) { goto jvzU6MkOnC_I; } goto RqUhLt9YiXHr; O4EIqSqOX52i: if (!($idx < $numwords)) { goto JiaH0xXYJp8p; } goto fErZZaPidO1v; c_TSUXEbNEww: $bit++; goto EnuNIPrK2xqx; HdX_V_KdJrjt: lnJ9FPlA_imW: goto VziGzAfHMezh; far2r0CvN1bO: if (!(!empty($bitstream[$pos]) || !isset($bitstream[$pos]))) { goto hMKcKbvhZpw0; } goto tRAryew_kX7A; MOmy6Indhv_O: EKJL3xyPXhYW: goto c_TSUXEbNEww; pa8CDGtUSihi: $numwords = intval(ceil($totbits / $wsize)); goto byDmNUZIoFCF; VziGzAfHMezh: $idx++; goto FyCqf2HLTkBg; UwjsXO3dLlvq: JiaH0xXYJp8p: goto t3PU67NT_4tK; tRAryew_kX7A: $wrd |= 1 << $wsize - $bit - 1; goto J9MuxvXjG7J5; byDmNUZIoFCF: $idx = 0; goto mX4TjwPbSMNJ; mX4TjwPbSMNJ: mMlVD0CaoLj5: goto O4EIqSqOX52i; FyCqf2HLTkBg: goto mMlVD0CaoLj5; goto UwjsXO3dLlvq; KwOTPtY2ETdR: $bit = 0; goto BeanOpMDIfH6; NyQS_w8gcNEd: } protected function addRawCwd($bits, $value) { $this->appendWordToBitstream($this->bitstream, $this->totbits, $bits, $value); } protected function addCdw($mode, $value) { $this->addRawCwd(Data::MODE_BITS[$mode], $value); } protected function addLatch($mode) { goto E4N1QL6lSXD8; E4N1QL6lSXD8: $latch = Data::LATCH_MAP[$this->encmode][$mode]; goto c9EtzdMy5aX1; NjKbA67az1DR: LSboAbT03yCl: goto kltcctJ8T2c3; c9EtzdMy5aX1: foreach ($latch as $cdw) { $this->addRawCwd($cdw[0], $cdw[1]); xU7updsc41y3: } goto NjKbA67az1DR; kltcctJ8T2c3: $this->encmode = $mode; goto qVPd1J450SJH; qVPd1J450SJH: } protected function addShift($mode) { goto j92oJm59PraR; j92oJm59PraR: $shift = Data::SHIFT_MAP[$this->encmode][$mode]; goto KSATuT41ORs9; KSATuT41ORs9: foreach ($shift as $cdw) { $this->addRawCwd($cdw[0], $cdw[1]); NsrJEWsQKETm: } goto BanO8GPAvi7L; BanO8GPAvi7L: iv8AAc7EdJjc: goto XUT4x_JLtusa; XUT4x_JLtusa: } protected function mergeTmpCwdWithShift($mode) { foreach ($this->tmpCdws as $item) { goto mHcsBtYd4tuO; mHcsBtYd4tuO: $this->addShift($mode); goto Tq4aJ7qiy91X; Tq4aJ7qiy91X: $this->addRawCwd($item[0], $item[1]); goto v29kLNR9kU_x; v29kLNR9kU_x: kwtqEA_6ayQJ: goto HJaie9SWunBD; HJaie9SWunBD: } XY27D4zBhvhP: } protected function mergeTmpCwdRaw() { foreach ($this->tmpCdws as $item) { $this->addRawCwd($item[0], $item[1]); ApEm93pBVq9O: } hCvlPgWoVC9C: } protected function mergeTmpCwd($mode = -1) { goto RIHydlvpQAL8; RIHydlvpQAL8: if ($mode < 0 || $this->encmode == $mode) { goto J6n0q7Y3sTSS; } goto cLMqMIo_QiZF; SKkZW2u_UqGI: $this->mergeTmpCwdRaw(); goto kQBMUCgsJCmm; IReC43NKPdgf: J6n0q7Y3sTSS: goto SKkZW2u_UqGI; AukaAeivD_P4: goto f4f8C4IfznZo; goto IReC43NKPdgf; cLMqMIo_QiZF: $this->mergeTmpCwdWithShift($mode); goto AukaAeivD_P4; iFTfM8a6EVFp: $this->tmpCdws = array(); goto OBFdpr4w1rsP; kQBMUCgsJCmm: f4f8C4IfznZo: goto iFTfM8a6EVFp; OBFdpr4w1rsP: } protected function addFLG($eci) { goto H1QrB9lv8Lgs; nSwvzDnRk7Ft: sON35tFFe63F: goto gLbLP_x6zKWR; eY0AAH5mNnok: return; goto ihBea2gPuvLQ; h2ScCHnHBjZI: $this->addShift(Data::MODE_PUNCT); goto MTQimuBWw3un; uI0_T9M_IShd: AwGQ_N0JTUgC: goto xTe6OfwYFIAL; gLbLP_x6zKWR: $idx++; goto PPlymlQS_KZr; lS6XsLg5vubC: $digits = strlen($seci); goto TA6Edj7imSaf; xTe6OfwYFIAL: if (!($this->encmode != Data::MODE_PUNCT)) { goto Bc6WSoR2qHrD; } goto h2ScCHnHBjZI; ihBea2gPuvLQ: j4_eV4Q3UJfI: goto JcA5gf8JcV3Z; u6_dtZbTlA1y: if (!($idx < $digits)) { goto ls893Dq_DepV; } goto E8hWkveNL66u; H1QrB9lv8Lgs: if (!($eci < 0)) { goto AwGQ_N0JTUgC; } goto bbX10twk6Ytq; PPlymlQS_KZr: goto DKdVEO1S1hA6; goto WZkn1PgVOaj1; SOmN3wbaSJFa: $idx = 0; goto aWpfxtdD_g92; E8hWkveNL66u: $this->addCdw(Data::MODE_DIGIT, $this->charEnc(Data::MODE_DIGIT, ord($seci[$idx]))); goto nSwvzDnRk7Ft; aWpfxtdD_g92: DKdVEO1S1hA6: goto u6_dtZbTlA1y; WZkn1PgVOaj1: ls893Dq_DepV: goto kszLxfTk3JA7; MTQimuBWw3un: Bc6WSoR2qHrD: goto hjixUUWtTrAV; hjixUUWtTrAV: if (!($eci == 0)) { goto j4_eV4Q3UJfI; } goto mUhgPorfzjLl; mUhgPorfzjLl: $this->addRawCwd(3, 0); goto eY0AAH5mNnok; bbX10twk6Ytq: return; goto uI0_T9M_IShd; TA6Edj7imSaf: $this->addRawCwd(3, $digits); goto SOmN3wbaSJFa; JcA5gf8JcV3Z: $seci = (string) $eci; goto lS6XsLg5vubC; kszLxfTk3JA7: } }
