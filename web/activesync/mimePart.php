<?php
/* CbPlus */
/*

*/
 class Mail_mimePart { protected $encoding; protected $subparts = array(); protected $encoded; protected $headers = array(); protected $body; protected $body_file; protected $preamble; protected $eol = "\xd\12"; public function __construct($body = '', $params = array()) { goto lbyAI3rrZ48E; i1JFOy17hm3z: G4OMKBs5mquu: goto iVDtkHTcEwI3; YwUeDH7D54nS: WxtZfLPRY7BY: goto CaBG9lPXVLca; KMJI3GBXzKvn: $this->encoded = array(); goto qBntnNfPDegc; dLFMJx7xpnWc: n1j6ZJBsAO9x: goto ekwLT4Zic5HA; Vm8O06wPy7RN: OjN24I9uuqr0: goto BkWWIENcGW4m; aV0X1oWADA5d: if (empty($params["\146\151\154\145\156\141\155\145"])) { goto GCQOH0Vadzjk; } goto wNZTdNA8JTXW; dzY_YBOoEDi_: $headers["\x43\157\x6e\164\145\156\x74\55\104\x69\x73\160\x6f\x73\x69\164\151\x6f\x6e"] .= $this->buildHeaderParam("\146\151\x6c\145\x6e\141\155\x65", $params["\146\151\x6c\x65\x6e\141\155\145"], $h_charset, $h_language, !empty($params["\x66\151\154\x65\x6e\x61\155\x65\x5f\145\156\143\157\x64\x69\x6e\x67"]) ? $params["\146\151\x6c\x65\156\141\155\145\x5f\x65\x6e\143\157\x64\x69\x6e\x67"] : null); goto abXtRHbAl91V; abXtRHbAl91V: TvwbNLoqPaPU: goto TKzLBkO8WdZ4; W1EbJ5YKT93H: o2XnanYipSUB: goto UCg_F_Di3LBk; bxPC8HgVUHV8: if (isset($this->encoding)) { goto cA6nD82jMM30; } goto oGLJ9zZ3MAmg; BkWWIENcGW4m: $headers["\x43\x6f\x6e\164\x65\156\x74\x2d\124\171\x70\x65"] = $params["\x63\157\x6e\164\145\156\x74\x5f\x74\171\x70\145"]; goto VZAT9LNEQTKH; h6RQACL6X3aP: if (!(!empty($params["\150\x65\141\x64\x65\x72\163"]) && is_array($params["\150\x65\141\144\x65\162\163"]))) { goto dlmHZJBMb70p; } goto MUXLGH5ba14e; VpCqhWAQoJAi: dlmHZJBMb70p: goto Mclo2DKyo9c4; sawIX2T7UuqN: if (isset($params["\150\145\x61\144\145\162\163\137\x63\x68\141\162\163\145\x74"])) { goto n1j6ZJBsAO9x; } goto OYeQcv2zL8GA; VZAT9LNEQTKH: if (empty($params["\x63\x68\x61\x72\163\145\164"])) { goto a3JvO1ddmCjR; } goto F0WJZ0MCpqoU; gBlPV3bfaFiC: $headers["\x43\x6f\x6e\164\145\156\164\x2d\104\x65\163\x63\x72\x69\x70\164\x69\157\156"] = $this->encodeHeader("\103\x6f\156\x74\x65\x6e\x74\55\104\x65\x73\x63\x72\x69\160\x74\151\x6f\x6e", $params["\144\145\x73\x63\x72\x69\x70\x74\151\157\x6e"], $h_charset, $h_encoding, $this->eol); goto u3s4drcTE2uJ; F0WJZ0MCpqoU: $charset = "\x63\150\x61\x72\x73\145\164\75{$params["\x63\150\x61\x72\x73\145\x74"]}"; goto GjEdGMx6WV1u; sY_f3O31wnEC: goto o2XnanYipSUB; goto nSNMcfeCJpS9; Y1tBRKv50kLT: if (empty($params["\x66\x69\x6c\145\156\x61\x6d\x65"])) { goto TvwbNLoqPaPU; } goto oqXJZVu03WNM; oHgQLuQonElv: $this->body = $body; goto edBZcEFGxUff; fAoYBEHxmTCp: goto Mq05m5QmPaH3; goto wyM7SEf6Ykog; ZM3MmXAK3pCX: if (!$size) { goto E3zVexNwZ4Lr; } goto Zxy4qhkKiU9L; GjEdGMx6WV1u: if (strlen($headers["\x43\157\156\164\145\156\x74\x2d\124\x79\160\x65"]) + strlen($charset) + 16 <= 76) { goto IgmgHOn1hpgh; } goto Z5gm6NcXxD_s; CaBG9lPXVLca: if (empty($params["\x64\x65\163\143\x72\151\160\x74\151\x6f\x6e"])) { goto jWYXI4hYfs6y; } goto gBlPV3bfaFiC; oqXJZVu03WNM: $headers["\103\157\x6e\x74\145\156\164\x2d\104\151\x73\160\157\x73\151\164\x69\157\x6e"] .= "\x3b" . $this->eol; goto dzY_YBOoEDi_; DkvTbY12tFdf: if (empty($params["\144\151\163\160\157\163\151\164\151\157\x6e"])) { goto WxtZfLPRY7BY; } goto dnj4VFLHh6nh; wNZTdNA8JTXW: $headers["\103\x6f\156\x74\x65\156\164\x2d\124\171\160\145"] .= "\x3b" . $this->eol; goto EaoVEohv0_Y_; h6QS9twytbhq: sYzuBY4vZPOE: goto bxPC8HgVUHV8; qBntnNfPDegc: $this->headers = $headers; goto oHgQLuQonElv; HW5OdLYGcgWL: $h_charset = !empty($params["\x68\x65\x61\x64\145\162\163\x5f\x63\150\x61\x72\163\145\164"]) ? $params["\150\x65\141\144\x65\x72\163\137\143\x68\x61\162\x73\145\x74"] : "\x55\x53\55\101\x53\x43\x49\111"; goto hffiFcPZm4U1; jcfD4YjP242j: if (!defined("\x4d\x41\111\114\137\x4d\111\115\x45\x50\x41\122\x54\x5f\x43\x52\114\x46")) { goto WKaBgFKf7wXc; } goto lvcOkqfdnRIp; VQARDb1MLOFK: $h_encoding = !empty($params["\156\x61\155\x65\x5f\x65\x6e\x63\x6f\144\151\x6e\x67"]) ? $params["\156\x61\x6d\145\x5f\145\156\143\x6f\144\151\x6e\147"] : null; goto aV0X1oWADA5d; Rbl2ecZX2cQr: $params["\x63\157\x6e\x74\145\156\x74\137\x74\x79\x70\x65"] = "\x74\x65\x78\x74\57\x70\154\x61\151\156"; goto Vm8O06wPy7RN; jAj8UOn3EF1P: $headers["\x43\x6f\156\164\145\156\x74\55\x54\171\x70\145"] .= "\73\40"; goto W1EbJ5YKT93H; dnj4VFLHh6nh: $headers["\103\157\156\164\145\156\x74\55\x44\151\x73\160\x6f\163\x69\164\151\x6f\x6e"] = $params["\x64\x69\x73\x70\x6f\163\151\164\x69\x6f\156"]; goto Y1tBRKv50kLT; lbyAI3rrZ48E: if (!empty($params["\x65\157\154"])) { goto ksGv21Jeb0kW; } goto jcfD4YjP242j; TKzLBkO8WdZ4: $size = $this->body_file ? filesize($this->body_file) : strlen($body); goto ZM3MmXAK3pCX; MUXLGH5ba14e: $headers = $params["\150\145\141\x64\145\x72\163"]; goto VpCqhWAQoJAi; wyM7SEf6Ykog: ksGv21Jeb0kW: goto lPa_rVvbWo3g; hffiFcPZm4U1: $h_language = !empty($params["\154\141\x6e\x67\x75\141\x67\145"]) ? $params["\154\x61\x6e\147\165\x61\147\145"] : null; goto VQARDb1MLOFK; CK7tBSyLGtoA: Mq05m5QmPaH3: goto h6RQACL6X3aP; Z5gm6NcXxD_s: $headers["\x43\x6f\x6e\x74\145\x6e\164\x2d\x54\171\160\145"] .= "\73" . $this->eol . "\x20"; goto sY_f3O31wnEC; Mclo2DKyo9c4: foreach ($params as $key => $value) { goto VBU75QY50fAh; wEN8YAoDpvOe: eU10K2qXCjYO: goto Dur54JdHaoCY; VBU75QY50fAh: switch ($key) { case "\x65\156\143\x6f\144\151\x6e\147": goto J_P9ZczNqEYW; J_P9ZczNqEYW: $this->encoding = $value; goto ImIUc0ThMTzz; QlfpoqphgYzC: goto Vaan5RAUYn2l; goto RO8YzHuR8IsH; ImIUc0ThMTzz: $headers["\x43\157\x6e\164\x65\x6e\164\x2d\124\162\141\x6e\x73\146\x65\162\55\x45\156\143\157\x64\151\x6e\x67"] = $value; goto QlfpoqphgYzC; RO8YzHuR8IsH: case "\143\x69\x64": $headers["\103\x6f\156\x74\x65\x6e\164\55\x49\104"] = "\74" . $value . "\x3e"; goto Vaan5RAUYn2l; case "\154\157\x63\141\x74\x69\157\156": $headers["\103\x6f\156\164\145\x6e\164\x2d\x4c\157\x63\141\x74\151\157\156"] = $value; goto Vaan5RAUYn2l; case "\142\157\144\x79\137\x66\x69\x6c\145": $this->body_file = $value; goto Vaan5RAUYn2l; case "\x70\x72\x65\141\155\x62\x6c\145": $this->preamble = $value; goto Vaan5RAUYn2l; case "\x64\146\x69\x6c\145\x6e\141\x6d\x65": $params["\146\x69\154\145\156\141\155\145"] = $value; goto Vaan5RAUYn2l; } goto S5FhiZ5skDXK; S5FhiZ5skDXK: F0HI0fOwCxA3: goto YlTHLhC5TmH5; YlTHLhC5TmH5: Vaan5RAUYn2l: goto wEN8YAoDpvOe; Dur54JdHaoCY: } goto i1JFOy17hm3z; owtSI_y8IoZr: GCQOH0Vadzjk: goto DkvTbY12tFdf; Zxy4qhkKiU9L: $headers["\x43\x6f\x6e\x74\145\x6e\164\x2d\x44\x69\x73\160\x6f\163\151\x74\151\x6f\x6e"] .= "\x3b" . $this->eol . "\x20\x73\151\172\x65\75" . $size; goto e6AuDaEvZ1HQ; btHU0CIwu3eB: cA6nD82jMM30: goto KMJI3GBXzKvn; nSNMcfeCJpS9: IgmgHOn1hpgh: goto jAj8UOn3EF1P; EaoVEohv0_Y_: $headers["\x43\157\156\x74\x65\156\164\x2d\x54\171\x70\145"] .= $this->buildHeaderParam("\x6e\x61\x6d\145", $params["\146\151\x6c\145\156\x61\155\145"], $h_charset, $h_language, $h_encoding); goto owtSI_y8IoZr; Dc89_9nIAhYr: foreach ($headers as $key => $value) { goto KTUXiVRpkFVT; C4fKjQNkJpx1: if (!(count($items) == 2)) { goto jfnFdAJA3jDR; } goto KevRGcFuJq_Q; zQqImjzaeO6u: jfnFdAJA3jDR: goto TnEn4u5F1BOJ; KevRGcFuJq_Q: $header = $items[0]; goto R67e0bySOSMV; oR57GLVB3RWQ: unset($headers[$key]); goto zQqImjzaeO6u; EPfVdsro2HA8: $headers[$header] .= $this->buildHeaderParam($param, $value, $h_charset, $h_language, $h_encoding); goto oR57GLVB3RWQ; XK7l3TTUef51: if (!isset($headers[$header])) { goto ssf4a0wvPa36; } goto kJXnqYWhOUoh; kJXnqYWhOUoh: $headers[$header] .= "\73" . $this->eol; goto Ng_JPuxau6tk; TnEn4u5F1BOJ: TZK1UGtXtQ28: goto Kr0IST7rWrGa; KTUXiVRpkFVT: $items = explode("\x3a", $key); goto C4fKjQNkJpx1; R67e0bySOSMV: $param = $items[1]; goto XK7l3TTUef51; Ng_JPuxau6tk: ssf4a0wvPa36: goto EPfVdsro2HA8; Kr0IST7rWrGa: } goto h6QS9twytbhq; oGLJ9zZ3MAmg: $this->encoding = "\67\142\x69\164"; goto btHU0CIwu3eB; OYeQcv2zL8GA: $params["\150\145\x61\x64\x65\x72\163\x5f\143\150\x61\162\163\x65\164"] = $params["\x63\x68\x61\x72\x73\145\164"]; goto dLFMJx7xpnWc; ekwLT4Zic5HA: a3JvO1ddmCjR: goto HW5OdLYGcgWL; UCg_F_Di3LBk: $headers["\103\157\x6e\x74\x65\x6e\x74\x2d\x54\x79\160\x65"] .= $charset; goto sawIX2T7UuqN; iVDtkHTcEwI3: if (!empty($params["\143\x6f\156\x74\145\156\164\137\164\x79\160\x65"])) { goto OjN24I9uuqr0; } goto Rbl2ecZX2cQr; u3s4drcTE2uJ: jWYXI4hYfs6y: goto Dc89_9nIAhYr; lvcOkqfdnRIp: $this->eol = MAIL_MIMEPART_CRLF; goto dC6aKfnclnjV; e6AuDaEvZ1HQ: E3zVexNwZ4Lr: goto YwUeDH7D54nS; lPa_rVvbWo3g: $this->eol = $params["\145\x6f\154"]; goto CK7tBSyLGtoA; dC6aKfnclnjV: WKaBgFKf7wXc: goto fAoYBEHxmTCp; edBZcEFGxUff: } public function encode($boundary = null) { goto tWHSRNoQYaw0; mxz2uc3wzhT8: if (!version_compare(PHP_VERSION, "\x35\56\x34\x2e\60", "\x3c")) { goto G7RAdGI1ndQH; } goto rTPIp3bYYgp9; fV56k6BHCV1S: $tmp = $this->subparts[$i]->encode(); goto sosmU1FM1VIx; vaEIjLh561zp: $encoded["\142\x6f\144\x79"] = $this->getEncodedData($this->body, $this->encoding); goto t2H16LiGpPD8; XZ33RvG_qCxB: $eol = $this->eol; goto s4O8lfkUAR8r; euLJt0fo5Ja8: return $encoded; goto psze1XDwLmAE; jqn58yLaf2LG: JozDUo4fnZ1v: goto YxXVn2dCH7G3; OPCY1eP71IxI: $encoded["\x62\157\x64\x79"] .= "\55\55" . $boundary . $eol; goto fV56k6BHCV1S; LIphoqe6s72j: $encoded["\x62\157\144\171"] = ''; goto F2Ib6awnhgPu; mJ0GYlNPtCUF: @ini_set("\155\x61\147\x69\143\x5f\x71\x75\157\164\145\x73\137\x72\x75\156\164\x69\155\145", $magic_quotes); goto yVj2DjQ7r2UL; tWHSRNoQYaw0: $encoded =& $this->encoded; goto fD0_8fSWqNhO; vvNeg4NABIkr: goto Dht0ZqZENyBo; goto YL8IZJGC221K; yVj2DjQ7r2UL: rB3dHhl0b7zS: goto WyDzxuKRjNol; z6HSgQ32VqwO: Dht0ZqZENyBo: goto hg3bf60u9JOg; CHmHLYfEktPM: $boundary = $boundary ? $boundary : "\75\137" . md5(rand() . microtime()); goto XZ33RvG_qCxB; FjoVDQPZSqIy: $body = $this->getEncodedDataFromFile($this->body_file, $this->encoding); goto wIMZfiAhbS3h; s4O8lfkUAR8r: $this->headers["\x43\157\156\x74\x65\156\x74\x2d\124\171\x70\x65"] .= "\x3b{$eol}\x20\x62\x6f\165\156\144\141\162\171\75\42{$boundary}\x22"; goto rp5M2iikdSgM; Vj3MRQKtG66o: foreach ($tmp["\x68\145\x61\144\145\x72\163"] as $key => $value) { $encoded["\142\157\144\x79"] .= $key . "\72\40" . $value . $eol; nFAUVZ1p0GSm: } goto jqn58yLaf2LG; SVGjBKpel3GI: return $tmp; goto eRFaYNTfzClO; o6IM2hRZJ_sd: $encoded["\142\x6f\x64\x79"] .= "\x2d\x2d" . $boundary . "\55\x2d" . $eol; goto SZ1HsowXrkKT; rTPIp3bYYgp9: $magic_quotes = @ini_set("\x6d\x61\147\151\143\137\x71\x75\157\164\145\163\x5f\x72\165\x6e\164\x69\155\x65", 0); goto DHlxclVN2Fbp; hg3bf60u9JOg: if (!($i < count($this->subparts))) { goto A72_0__jryCG; } goto OPCY1eP71IxI; HHb0eTGk6aUy: if ($this->body) { goto P15w8fnMw_sg; } goto JMcq4ar8q15v; msFpIbAiQr4W: $i++; goto vvNeg4NABIkr; Em8wzEnxbZno: B3xL2JKx3HdB: goto CHmHLYfEktPM; TXvT70qdjIM7: $encoded["\x62\157\x64\x79"] = $body; goto BdkWNYTP18U8; K_nLT7ve7206: $encoded["\x62\x6f\144\x79"] .= $this->preamble . $eol . $eol; goto EKtME4_AxU3e; YviL6dkMcyPH: MCY6kyH5ILwQ: goto TXvT70qdjIM7; EKtME4_AxU3e: eYaR_2TLwC4T: goto VnUsgz7_IrOs; sosmU1FM1VIx: if (!(false === $tmp)) { goto f9m_13knJZ89; } goto SVGjBKpel3GI; YL8IZJGC221K: A72_0__jryCG: goto o6IM2hRZJ_sd; Ww2s6tvUmGSp: return $body; goto YviL6dkMcyPH; e03DbHxu2cne: goto J7ZC_LuqXn0Z; goto Em8wzEnxbZno; BdkWNYTP18U8: RkcKq3RGzMfu: goto E6rM_e5PJ1pV; YSGBWxRJOul2: if (!$this->preamble) { goto eYaR_2TLwC4T; } goto K_nLT7ve7206; Cokw8bAKfW1G: cT62Yn7M7inL: goto mxz2uc3wzhT8; DHlxclVN2Fbp: G7RAdGI1ndQH: goto FjoVDQPZSqIy; UTLQj35iu8aL: cLrIAhSVzMzL: goto msFpIbAiQr4W; WyDzxuKRjNol: if (!(false === $body)) { goto MCY6kyH5ILwQ; } goto Ww2s6tvUmGSp; U7Rq2k2bnT6e: $encoded["\x68\x65\141\144\x65\162\x73"] =& $this->headers; goto euLJt0fo5Ja8; YxXVn2dCH7G3: $encoded["\142\x6f\x64\171"] .= $eol . $tmp["\142\x6f\x64\x79"] . $eol; goto UTLQj35iu8aL; VnUsgz7_IrOs: $i = 0; goto z6HSgQ32VqwO; fD0_8fSWqNhO: if (count($this->subparts)) { goto B3xL2JKx3HdB; } goto HHb0eTGk6aUy; SZ1HsowXrkKT: J7ZC_LuqXn0Z: goto U7Rq2k2bnT6e; eRFaYNTfzClO: f9m_13knJZ89: goto Vj3MRQKtG66o; KsV24TVdt4io: P15w8fnMw_sg: goto vaEIjLh561zp; F2Ib6awnhgPu: goto RkcKq3RGzMfu; goto Cokw8bAKfW1G; JMcq4ar8q15v: if ($this->body_file) { goto cT62Yn7M7inL; } goto LIphoqe6s72j; wIMZfiAhbS3h: if (!isset($magic_quotes)) { goto rB3dHhl0b7zS; } goto mJ0GYlNPtCUF; rp5M2iikdSgM: $encoded["\x62\x6f\x64\x79"] = ''; goto YSGBWxRJOul2; E6rM_e5PJ1pV: goto z0NF34xfovjQ; goto KsV24TVdt4io; t2H16LiGpPD8: z0NF34xfovjQ: goto e03DbHxu2cne; psze1XDwLmAE: } public function encodeToFile($filename, $boundary = null, $skip_head = false) { goto IqaZZA6Yv0Hh; U9zlbrca0xT9: if ($fh = fopen($filename, "\141\x62")) { goto vTFTGFkfr3h_; } goto UZxYMAiPPWsT; aXrH6_KFIgOa: return $err; goto dJ4tgrSREIT2; kgL_UsLP2Lsj: $err = self::raiseError("\x46\x69\154\145\40\151\163\40\156\x6f\164\40\x77\162\151\164\145\x61\142\154\x65\x3a\x20" . $filename); goto aXrH6_KFIgOa; OxdB4f_cux3y: return $this->headers; goto B21JWLmGJ8Fw; rQatPrOmTBF4: return $err; goto LUi2UnEoe8vf; UZxYMAiPPWsT: $err = self::raiseError("\125\x6e\141\142\x6c\x65\40\164\157\40\157\160\x65\156\x20\x66\x69\x6c\x65\72\x20" . $filename); goto rQatPrOmTBF4; E1KGQyIYmQnd: $fh = $filename; goto rXF1hYEIUacQ; W3wTd_RGjyO_: yYvH745KVKFh: goto EYsfjB2HAQKb; krk1E9WhCKsw: @ini_set("\155\x61\x67\151\x63\137\x71\165\157\x74\145\x73\137\x72\165\156\164\x69\155\145", $magic_quotes); goto rlRJ5HD30HXV; T3GNkzxk4RGe: HPKZd1UH6iuO: goto B3qK7RNCR2ZV; bZUOI0C6IWi0: if (!(file_exists($filename) && !is_writable($filename))) { goto kVnvudIFeV2I; } goto kgL_UsLP2Lsj; rlRJ5HD30HXV: S6tjrGkT20UM: goto aGnG667uTU5N; B3qK7RNCR2ZV: $res = $this->encodePartToFile($fh, $boundary, $skip_head); goto WxtVrbx2XUXS; JtpPjcmnZ5CV: fclose($fh); goto Xa5Mz1AMz5mv; dJ4tgrSREIT2: kVnvudIFeV2I: goto U9zlbrca0xT9; WxtVrbx2XUXS: if (is_resource($filename)) { goto oDNkjd9iwYhu; } goto JtpPjcmnZ5CV; YxVXlSOFkCBs: tj_oAvAMbj8Q: goto bZUOI0C6IWi0; Xa5Mz1AMz5mv: oDNkjd9iwYhu: goto edt0nQaH9W9r; nwcqGtdadVlC: i9BWJ0uYx7mx: goto OxdB4f_cux3y; EYsfjB2HAQKb: if (!version_compare(PHP_VERSION, "\65\x2e\x34\56\60", "\x3c")) { goto HPKZd1UH6iuO; } goto G1UFmZawRqsR; aGnG667uTU5N: if (!(false === $res)) { goto i9BWJ0uYx7mx; } goto e978t2AyK0uh; e978t2AyK0uh: return $res; goto nwcqGtdadVlC; LUi2UnEoe8vf: vTFTGFkfr3h_: goto W3wTd_RGjyO_; G1UFmZawRqsR: $magic_quotes = @ini_set("\155\x61\147\151\143\x5f\x71\165\x6f\x74\x65\163\137\x72\x75\156\164\x69\x6d\x65", 0); goto T3GNkzxk4RGe; rXF1hYEIUacQ: goto yYvH745KVKFh; goto YxVXlSOFkCBs; IqaZZA6Yv0Hh: if (!is_resource($filename)) { goto tj_oAvAMbj8Q; } goto E1KGQyIYmQnd; edt0nQaH9W9r: if (!isset($magic_quotes)) { goto S6tjrGkT20UM; } goto krk1E9WhCKsw; B21JWLmGJ8Fw: } protected function encodePartToFile($fh, $boundary = null, $skip_head = false) { goto es0th7dgFqCG; pB2ouBCMpUUj: fwrite($fh, $eol . "\55\x2d" . $boundary . "\55\55" . $eol); goto PcbRIBQdgAV4; Yz2Ze8pDwiOE: if (!$skip_head) { goto uS21LokQTBGs; } goto xd0BF5y7tCVG; QaTE2EZuumIO: return $res; goto BbHxXLv4HZ1r; vPo0stfidf4j: goto c3qDt3M6bLu1; goto HPnjr2uDlmuk; es0th7dgFqCG: $eol = $this->eol; goto uYTRWu7Oej8S; mm0DCJOJ6up3: goto E5FUULrCnCjw; goto NQpeReiFjUqw; opcQYnLUlEgv: $i = 0; goto WBL7gtfbif0d; O7EGFr0b2k6W: $this->headers["\103\x6f\x6e\x74\x65\x6e\164\x2d\x54\x79\160\x65"] .= "\x3b{$eol}\40\142\157\x75\156\144\x61\x72\x79\x3d\42{$boundary}\42"; goto kRHJb4qwtOXI; HPnjr2uDlmuk: na6fANKhOpys: goto xyiyZT4JzFQU; BbHxXLv4HZ1r: lDqEFnCgy96R: goto ydsfLQ2HOrHD; WBL7gtfbif0d: oKoT4ZnT4cG0: goto RMXYUkZKJPZ3; KkdjxCfag350: if (!(false === $res)) { goto NOkob47AqxFT; } goto uYPSsSUJ3EFG; Iv10g0J9QEhY: E1VPk4waI5QR: goto opcQYnLUlEgv; ESH7f05M3Ca8: aHvbcGV6N3t5: goto hDiTawrzVpqb; SfqJxZR2eXhP: if (count($this->subparts)) { goto aHvbcGV6N3t5; } goto yzOLCgUq5vZT; PcbRIBQdgAV4: dweOcG12onBc: goto gDZsOhxENvFJ; mQzfpSWNsPvu: $res = $this->getEncodedDataFromFile($this->body_file, $this->encoding, $fh); goto KkdjxCfag350; iyu5Yed9pMMc: foreach ($this->headers as $key => $value) { fwrite($fh, $key . "\x3a\40" . $value . $eol); yuVid1lRtI0K: } goto nB5DzdDLLtm7; kRHJb4qwtOXI: sKhGCLUJG7Wa: goto Yz2Ze8pDwiOE; WhB3s3WJQOmc: $res = $this->subparts[$i]->encodePartToFile($fh); goto E5DenF5NB93v; hDiTawrzVpqb: if (!$this->preamble) { goto E1VPk4waI5QR; } goto UTQmEDOzhxRW; RMXYUkZKJPZ3: if (!($i < count($this->subparts))) { goto wUTgxnJKS2bY; } goto IoAkopVPKeS0; eAdp0fV0cO9b: kZz2etWOPRHL: goto p9idDjA0hP4U; gDZsOhxENvFJ: return true; goto hNj2A0AoEBi_; uBaumdwZTz7H: wUTgxnJKS2bY: goto pB2ouBCMpUUj; yzOLCgUq5vZT: if ($this->body) { goto na6fANKhOpys; } goto UaI5eGhvWgUm; fjVzROpaUFg6: NOkob47AqxFT: goto GDS7KfxS0ZV_; ykA3pO2Kwoc5: E5FUULrCnCjw: goto SfqJxZR2eXhP; JyqTDhM5BO6x: goto oKoT4ZnT4cG0; goto uBaumdwZTz7H; E5DenF5NB93v: if (!(false === $res)) { goto lDqEFnCgy96R; } goto QaTE2EZuumIO; hd2Cmn9qYawg: c3qDt3M6bLu1: goto wcVkSe6iMMY8; ahH2dSHuBGRF: $boundary = $boundary ? $boundary : "\x3d\137" . md5(rand() . microtime()); goto O7EGFr0b2k6W; UTQmEDOzhxRW: fwrite($fh, $f_eol . $this->preamble . $eol); goto oc2eszCv1FkP; rD33b4jKQP72: fwrite($fh, $f_eol); goto mQzfpSWNsPvu; uYPSsSUJ3EFG: return $res; goto fjVzROpaUFg6; xd0BF5y7tCVG: $f_eol = ''; goto mm0DCJOJ6up3; k9W2gfJA4E7S: $f_eol = $eol; goto ykA3pO2Kwoc5; uYTRWu7Oej8S: if (!count($this->subparts)) { goto sKhGCLUJG7Wa; } goto ahH2dSHuBGRF; oc2eszCv1FkP: $f_eol = $eol; goto Iv10g0J9QEhY; UaI5eGhvWgUm: if (!$this->body_file) { goto MwF1g7YQUm_9; } goto rD33b4jKQP72; p9idDjA0hP4U: $i++; goto JyqTDhM5BO6x; wcVkSe6iMMY8: goto dweOcG12onBc; goto ESH7f05M3Ca8; ydsfLQ2HOrHD: $f_eol = $eol; goto eAdp0fV0cO9b; IoAkopVPKeS0: fwrite($fh, $f_eol . "\x2d\x2d" . $boundary . $eol); goto WhB3s3WJQOmc; NQpeReiFjUqw: uS21LokQTBGs: goto iyu5Yed9pMMc; GDS7KfxS0ZV_: MwF1g7YQUm_9: goto vPo0stfidf4j; xyiyZT4JzFQU: fwrite($fh, $f_eol); goto y36jc6HhRdso; nB5DzdDLLtm7: xM2hEqShoADN: goto k9W2gfJA4E7S; y36jc6HhRdso: fwrite($fh, $this->getEncodedData($this->body, $this->encoding)); goto hd2Cmn9qYawg; hNj2A0AoEBi_: } public function addSubpart($body, $params = null) { goto WQlRNXncJrsl; zLci9u82kC70: $this->subparts[] = $part; goto lXicoOo86kI8; lXicoOo86kI8: return $part; goto ch2YRKZdElpf; ubdlUdSWYCtQ: JuvxkMXGD8v_: goto cUSPDyMHrJYZ; WQlRNXncJrsl: if ($body instanceof Mail_mimePart) { goto JuvxkMXGD8v_; } goto qpKtNIj0WHvi; BluZTA7K3Zva: DhWj7m1g7iPR: goto zLci9u82kC70; cUSPDyMHrJYZ: $part = $body; goto BluZTA7K3Zva; qpKtNIj0WHvi: $part = new Mail_mimePart($body, $params); goto s11fbApcsCO2; s11fbApcsCO2: goto DhWj7m1g7iPR; goto ubdlUdSWYCtQ; ch2YRKZdElpf: } protected function getEncodedData($data, $encoding) { goto wVu1CP8pLf5X; wVu1CP8pLf5X: switch ($encoding) { case "\x71\x75\x6f\164\145\x64\x2d\160\x72\x69\x6e\x74\141\x62\x6c\x65": return self::quotedPrintableEncode($data, 76, $this->eol); goto hFLgh6IRYRpu; case "\142\x61\x73\145\x36\x34": return rtrim(chunk_split(base64_encode($data), 76, $this->eol)); goto hFLgh6IRYRpu; case "\x38\x62\151\164": case "\x37\142\151\x74": default: return $data; } goto RW2f3DtUKv8U; hkvCwNtTS96L: hFLgh6IRYRpu: goto AVMKLgkl2VlA; RW2f3DtUKv8U: YJwqwHLx_LRa: goto hkvCwNtTS96L; AVMKLgkl2VlA: } protected function getEncodedDataFromFile($filename, $encoding, $fh = null) { goto fVCk2jjbvTwB; MFweYQ5ehbQq: RqWBkQoty1Hl: goto cxhXmw6y7k3G; zHNijExMYM9x: switch ($encoding) { case "\161\x75\x6f\x74\145\144\x2d\x70\x72\151\156\x74\x61\142\x6c\145": goto UjykHdg0ENeU; aTAcJ9Bch97R: if (feof($fd)) { goto jI333ztAA_oi; } goto k9ywytxjld3M; k9ywytxjld3M: $buffer = self::quotedPrintableEncode(fgets($fd), 76, $this->eol); goto K3iRDYwMWDWg; K3iRDYwMWDWg: if ($fh) { goto S0HD5oqXlTXW; } goto uXdVBzduq8rU; deQy6H0Fq5_m: UE405vJ8frB1: goto wW6ykwlj1ODk; R2tZyjDiMmPa: jI333ztAA_oi: goto pi5Jinkd0Gkx; UjykHdg0ENeU: AVb1w0thI0vu: goto aTAcJ9Bch97R; svWYBgYiQxMb: fwrite($fh, $buffer); goto deQy6H0Fq5_m; pi5Jinkd0Gkx: goto FvNc63p3R3lS; goto FAVclTD3s4MM; zwaYaCW5D7v4: S0HD5oqXlTXW: goto svWYBgYiQxMb; iERkvJuaqG9h: goto UE405vJ8frB1; goto zwaYaCW5D7v4; wW6ykwlj1ODk: goto AVb1w0thI0vu; goto R2tZyjDiMmPa; uXdVBzduq8rU: $data .= $buffer; goto iERkvJuaqG9h; FAVclTD3s4MM: case "\x62\x61\x73\x65\66\x34": goto AQcn8L1e6Fee; df4AeGQ9CDXS: uqHhQsBbEQAb: goto uEh36HS9c7kz; yS9eQc1o4qn5: goto pEqE3dQElO0F; goto df4AeGQ9CDXS; XMoPerCvZm8o: $buffer = chunk_split($buffer, 76, $this->eol); goto OUk2Z1GSMAZb; zJyEiF2Rs7yx: $buffer = base64_encode($buffer); goto XMoPerCvZm8o; WIVtvglZexYz: if (feof($fd)) { goto OkPH88PcWtaB; } goto V9Lo3ikeicNr; uEh36HS9c7kz: fwrite($fh, $buffer); goto HlJlsFz1aQCA; ougbMHmyI5sq: goto AEWdrxC4kXcI; goto gdwcPmQ9lAVB; OUk2Z1GSMAZb: if (!feof($fd)) { goto zr56rKDqRSTP; } goto alPOlCEud_Ec; N_RHt20XsPUv: goto FvNc63p3R3lS; goto SbrN2qxRrXFf; gdwcPmQ9lAVB: OkPH88PcWtaB: goto N_RHt20XsPUv; alPOlCEud_Ec: $buffer = rtrim($buffer); goto CU5b9btQY_LH; HlJlsFz1aQCA: pEqE3dQElO0F: goto ougbMHmyI5sq; CU5b9btQY_LH: zr56rKDqRSTP: goto XHzMEDK4d7wm; AQcn8L1e6Fee: AEWdrxC4kXcI: goto WIVtvglZexYz; V9Lo3ikeicNr: $buffer = fread($fd, 57 * 9198); goto zJyEiF2Rs7yx; XHzMEDK4d7wm: if ($fh) { goto uqHhQsBbEQAb; } goto ovfh8NanC82v; ovfh8NanC82v: $data .= $buffer; goto yS9eQc1o4qn5; SbrN2qxRrXFf: case "\70\x62\x69\164": case "\67\142\151\164": default: goto pKW0lj0thi5W; laGrcMkjWJGM: uUD8W1sxI7dg: goto pUozximeus11; pKW0lj0thi5W: zgHp112H3gkD: goto KNC14rMCpLIM; lkEaKNCX0TLw: goto zgHp112H3gkD; goto laGrcMkjWJGM; KNC14rMCpLIM: if (feof($fd)) { goto uUD8W1sxI7dg; } goto CAlNM37Yjelw; CAlNM37Yjelw: $buffer = fread($fd, 1048576); goto TUEwl8z2vBiW; M_3qJLp2hRDK: goto O8gi79JNDp5G; goto a8PRylY0ptrX; TUEwl8z2vBiW: if ($fh) { goto msFLt3mVchJ1; } goto N1ZP8vMg4g7R; lDZlDtjNIUCq: O8gi79JNDp5G: goto lkEaKNCX0TLw; e4NuqdN0Z3Xe: fwrite($fh, $buffer); goto lDZlDtjNIUCq; N1ZP8vMg4g7R: $data .= $buffer; goto M_3qJLp2hRDK; a8PRylY0ptrX: msFLt3mVchJ1: goto e4NuqdN0Z3Xe; pUozximeus11: } goto gFsKl3pgz08c; DpBsvmuX30py: $data = ''; goto zHNijExMYM9x; PUnDAFOqjOEo: $err = self::raiseError("\x55\x6e\141\x62\154\x65\40\x74\157\x20\x72\145\x61\144\40\146\x69\x6c\145\72\40" . $filename); goto BEQEXBsVP2bC; fVCk2jjbvTwB: if (is_readable($filename)) { goto fEYj9SlV3h4l; } goto PUnDAFOqjOEo; IZrEWs8O0NU2: $err = self::raiseError("\x43\157\x75\x6c\x64\40\156\x6f\x74\x20\x6f\160\145\156\x20\x66\x69\154\145\72\40" . $filename); goto beNZSDnQnnjb; gFsKl3pgz08c: VWJSjoijOUho: goto EQ7EvLgDSLui; sNBSEWtut0TW: fEYj9SlV3h4l: goto XULx2jIYEMx6; Wlg4KzACNdpb: RMO_9wWg0wD3: goto DpBsvmuX30py; XULx2jIYEMx6: if ($fd = fopen($filename, "\162\142")) { goto RMO_9wWg0wD3; } goto IZrEWs8O0NU2; QohzzvpMN3ZA: if ($fh) { goto RqWBkQoty1Hl; } goto C1bYENYoGtN8; C1bYENYoGtN8: return $data; goto MFweYQ5ehbQq; EQ7EvLgDSLui: FvNc63p3R3lS: goto bA2wePsvEeIR; bA2wePsvEeIR: fclose($fd); goto QohzzvpMN3ZA; beNZSDnQnnjb: return $err; goto Wlg4KzACNdpb; BEQEXBsVP2bC: return $err; goto sNBSEWtut0TW; cxhXmw6y7k3G: } public static function quotedPrintableEncode($input, $line_max = 76, $eol = "\15\xa") { goto dOOEdGN5DgKO; ECXRjAUPeM3g: $output = substr($output, 0, -1 * strlen($eol)); goto JctTUIEhVUsG; ifokpEAsz43v: $output = ''; goto EaTRo9OKtbzS; JctTUIEhVUsG: return $output; goto fnyCpCPikLTG; KHKFIO4x2BAR: $escape = "\x3d"; goto ifokpEAsz43v; dOOEdGN5DgKO: $lines = preg_split("\57\15\x3f\12\57", $input); goto KHKFIO4x2BAR; gXe75Iz4xRcH: Ldgf5lFXeN37: goto ECXRjAUPeM3g; EaTRo9OKtbzS: foreach ($lines as $idx => $line) { goto XzqRTZLGvpjH; APFEa0Yf_hgL: We9mkND8uZjp: goto zhYjyKGkWD5N; lY8cYqbvSele: $char = "\75\x32\x30"; goto sDn_emcLA38J; RknCI2AD8WfE: if ($dec == 61 || $dec < 32 || $dec > 126) { goto kf5TTuwcZ_pT; } goto afXqJNnmHCwh; XzqRTZLGvpjH: $newline = ''; goto b3e3GmCrXWaR; Gm_c7GFUXrHc: goto bF20pfpJN9Fj; goto BCDPWv8Aie38; FSrA6mDHrexM: if ($dec == 9 && isset($line[$i])) { goto d3bUqqBzQxxS; } goto RknCI2AD8WfE; LawG2O2i9yRm: $output .= $newline . $eol; goto F4xCchHzk0wT; BCDPWv8Aie38: kf5TTuwcZ_pT: goto rQnkDYLnYoLE; F21NuXnSP_b8: goto gKa7fJJYY2A4; goto htOLc7bXy0Kd; gn1vC1Zz5J58: bF20pfpJN9Fj: goto dgXXQnir_Nr7; lE7GoRKA0BEb: gKa7fJJYY2A4: goto c8pB3x5AKPuv; rQnkDYLnYoLE: $char = $escape . sprintf("\x25\x30\x32\x58", $dec); goto IiUptFFwCM0P; htOLc7bXy0Kd: TwIGeNggsQMj: goto L43n1Cy5t1MA; Ga_BJNWWuLKt: lUuAcYzmLfXg: goto a0cotIQEepol; c8pB3x5AKPuv: $newline .= $char; goto AHkUuhvh_Mb0; bD3txTz0wcxe: if ($dec == 32 && !isset($line[$i])) { goto W8VzUSsO5met; } goto FSrA6mDHrexM; BaWIIue2Yrdq: $newline = ''; goto lE7GoRKA0BEb; O2_ObeeqVVSM: $i++; goto bD3txTz0wcxe; a0cotIQEepol: if (!isset($line[$i])) { goto OXyx880h_bkS; } goto w8knJ3Nvbvei; IiUptFFwCM0P: goto bF20pfpJN9Fj; goto c5hB2QRvb4oG; SI0a5GLs_HMR: $dec = ord($char); goto O2_ObeeqVVSM; dgXXQnir_Nr7: if (strlen($newline) + strlen($char) == $line_max && !isset($line[$i])) { goto TwIGeNggsQMj; } goto eqLT9WZqjC0n; AHkUuhvh_Mb0: goto lUuAcYzmLfXg; goto X1xniDJgx6ln; afXqJNnmHCwh: if ($dec == 46 && ($newline == '' || strlen($newline) + strlen("\56\x3d") > $line_max && isset($line[$i]))) { goto HuadwxmXFvgV; } goto SX1JFVdUxGGj; HjhaLvnSin2N: d3bUqqBzQxxS: goto Gm_c7GFUXrHc; M_PtjGNPZ0WU: W8VzUSsO5met: goto lY8cYqbvSele; L43n1Cy5t1MA: goto gKa7fJJYY2A4; goto APFEa0Yf_hgL; zhYjyKGkWD5N: $output .= $newline . $escape . $eol; goto BaWIIue2Yrdq; sDn_emcLA38J: goto bF20pfpJN9Fj; goto HjhaLvnSin2N; F4xCchHzk0wT: unset($lines[$idx]); goto y542kq2p5TLW; c5hB2QRvb4oG: HuadwxmXFvgV: goto exfSgi2NyUtq; eqLT9WZqjC0n: if (strlen($newline) + strlen($char) >= $line_max) { goto We9mkND8uZjp; } goto F21NuXnSP_b8; b3e3GmCrXWaR: $i = 0; goto Ga_BJNWWuLKt; y542kq2p5TLW: aINQPbtYM3X4: goto qdlj42QFyC5m; exfSgi2NyUtq: $char = "\x3d\62\105"; goto gn1vC1Zz5J58; w8knJ3Nvbvei: $char = $line[$i]; goto SI0a5GLs_HMR; X1xniDJgx6ln: OXyx880h_bkS: goto LawG2O2i9yRm; SX1JFVdUxGGj: goto bF20pfpJN9Fj; goto M_PtjGNPZ0WU; qdlj42QFyC5m: } goto gXe75Iz4xRcH; fnyCpCPikLTG: } protected function buildHeaderParam($name, $value, $charset = null, $language = null, $encoding = null, $maxLength = 75) { goto aKd8Swjm2Mwg; OxT4pR0TsOPG: alYBBpDSumDo: goto wrON0Ht7bLKF; FUsdj8Kz0T8P: P9uJGoSI4uCx: goto vI5nim73ehAO; uC3glWFMgAI2: $value = substr($value, strlen($matches[0])); goto jiJ3ACFs6s1x; VKuTlpOyKVNW: Gzqu0Whr04XB: goto nW6H52Y7qPeW; mLkdDaKjwlsA: if (!(strlen($header) <= $maxLength)) { goto Rgpj3OQPdvip; } goto kCJf6XEjFQbk; Ty3ZIN9beEBg: $preLength = strlen("\40{$name}\x2a\x30\52\x3d"); goto bLVyqyMxSH1n; ZU0AiIt__im3: if (!(strlen($name) + strlen($quoted) + 5 <= $maxLength)) { goto Gzqu0Whr04XB; } goto bvSAwFFvTNyd; MOcwqDqTqBEt: $matches = array(); goto a36fz19RO_C6; Sgh3MQgkB4LI: qRwLS13F2KXD: goto L63xfaxGl3xe; aKd8Swjm2Mwg: if (preg_match("\x23\x5b\x5e\134\170\x32\x30\x2d\134\170\67\105\x5d\43", $value)) { goto P9uJGoSI4uCx; } goto BURgkMmD_Udk; HMyCyuKT7Ert: $header = "\x20{$name}\x2a\75{$value}"; goto mLkdDaKjwlsA; ijm5xZpM7OUe: $headers = array(); goto UiMp2qYlh413; ugz3akZsbkX2: ZRDZ3LXIkwt_: goto Pf8vucCllAAe; PCQ6nMHY0ZaI: $headers[] = "\x20{$name}\52{$headCount}\x2a\x3d{$matches[0]}"; goto uC3glWFMgAI2; godbjDYwmxQs: $quoted = addcslashes($value, "\134\x22"); goto ZU0AiIt__im3; NDVMYcc5N1Au: goto CnbUDFfHYZR3; goto kivrR54GPpn7; UiMp2qYlh413: $headCount = 0; goto Sgh3MQgkB4LI; RkqiynXX6kLR: MRR_5KA2NahL: goto cTc2viFS7804; waPtY5xbNG2n: return $headers; goto uRLv9JKdRscz; YD0ol5vlq723: $headCount++; goto bz3IKViVvnDx; kCJf6XEjFQbk: return $header; goto ORp1U3smsZvl; FGuVE6O3rtjr: $maxLengthReg = "\174\50\56\x7b\60\54{$maxLength}\x7d\x5b\x5e\x5c\45\x5d\133\x5e\x5c\45\x5d\x29\x7c"; goto ijm5xZpM7OUe; qjAWT_3r8ULr: $value = "{$charset}\47{$language}\x27{$encValue}"; goto HMyCyuKT7Ert; kivrR54GPpn7: zEhzZ4cweXWB: goto PCQ6nMHY0ZaI; r4bpyu4y1jW4: rhT4bdz2jRQa: goto sTZXTXldJ2M5; Pf8vucCllAAe: $encValue = preg_replace_callback("\x2f\50\133\x5e\x5c\x78\62\x31\x5c\x78\62\x33\x5c\170\62\64\x5c\170\62\66\134\170\62\102\134\x78\x32\x44\x5c\170\x32\x45\x5c\x78\63\x30\x2d\134\x78\x33\x39\x5c\170\64\x31\x2d\x5c\170\65\101\134\x78\65\x45\x2d\134\170\x37\x45\x5d\51\57", array($this, "\x65\156\143\157\144\145\x52\x65\160\x6c\141\x63\x65\103\x61\154\x6c\x62\x61\x63\x6b"), $value); goto qjAWT_3r8ULr; wrON0Ht7bLKF: $headers = implode("\73" . $this->eol, $headers); goto waPtY5xbNG2n; Wwvc5pz9mxKQ: $value = ''; goto NDVMYcc5N1Au; UxtcvhOdcCf7: if ($found) { goto zEhzZ4cweXWB; } goto QfLhUd7C5s0Y; bz3IKViVvnDx: goto qRwLS13F2KXD; goto OxT4pR0TsOPG; a36fz19RO_C6: $found = preg_match($maxLengthReg, $value, $matches); goto UxtcvhOdcCf7; bLVyqyMxSH1n: $maxLength = max(16, $maxLength - $preLength - 3); goto FGuVE6O3rtjr; ORp1U3smsZvl: Rgpj3OQPdvip: goto Ty3ZIN9beEBg; BURgkMmD_Udk: $token_regexp = "\x23\x28\133\x5e\x5c\170\62\x31\134\170\x32\x33\x2d\x5c\x78\x32\67\x5c\170\x32\101\134\x78\x32\102\x5c\x78\x32\x44" . "\x5c\170\x32\105\x5c\170\63\x30\55\134\170\63\x39\134\x78\x34\61\x2d\134\x78\65\x41\x5c\170\65\105\55\134\170\x37\x45\135\x29\x23"; goto brll9wrg2NQ8; jiJ3ACFs6s1x: CnbUDFfHYZR3: goto YD0ol5vlq723; cTc2viFS7804: kgiZ9_S2kTdx: goto FUsdj8Kz0T8P; nW6H52Y7qPeW: goto kgiZ9_S2kTdx; goto r4bpyu4y1jW4; Flbzq96dYDS6: return "\x20{$name}\x3d{$value}"; goto RkqiynXX6kLR; brll9wrg2NQ8: if (!preg_match($token_regexp, $value)) { goto rhT4bdz2jRQa; } goto godbjDYwmxQs; L63xfaxGl3xe: if (!$value) { goto alYBBpDSumDo; } goto MOcwqDqTqBEt; QfLhUd7C5s0Y: $headers[] = "\x20{$name}\52{$headCount}\52\x3d{$value}"; goto Wwvc5pz9mxKQ; bvSAwFFvTNyd: return "\x20{$name}\75\42{$quoted}\42"; goto VKuTlpOyKVNW; vI5nim73ehAO: if (!($encoding == "\x71\165\157\x74\x65\x64\55\160\x72\x69\156\x74\141\142\x6c\x65" || $encoding == "\x62\141\163\145\x36\64")) { goto ZRDZ3LXIkwt_; } goto Py91colgefKg; sTZXTXldJ2M5: if (!(strlen($name) + strlen($value) + 3 <= $maxLength)) { goto MRR_5KA2NahL; } goto Flbzq96dYDS6; Py91colgefKg: return $this->buildRFC2047Param($name, $value, $charset, $encoding); goto ugz3akZsbkX2; uRLv9JKdRscz: } protected function buildRFC2047Param($name, $value, $charset, $encoding = "\x71\x75\157\x74\x65\144\x2d\x70\x72\151\156\x74\x61\142\154\x65", $maxLength = 76) { goto OsxVFTdPjZkW; ytUAS6bXP1Ng: $quoted .= $prefix . $value . $suffix; goto Z0eqMvFMvjBQ; Otr1ZRtduP8l: if (!($len > $maxLength)) { goto Ksl56qQSr0ZC; } goto bRSm3_745RVq; XyIZeYYXmvdh: Ksl56qQSr0ZC: goto ytUAS6bXP1Ng; Vbd7Lv8Fi9r1: if (!preg_match("\x2f\x5e\x28\x2e\x7b\60\54{$length}\x7d\133\x5e\134\x3d\x5d\133\136\134\x3d\135\x29\57", $value, $matches)) { goto WP8nkBuiAAZ2; } goto SgKf3LpdWvl4; LKPIYlBwG1hZ: WwVtdeP2vnTe: goto tA7z0SC3gMS7; wVjAdCbPptWn: $value = substr($value, strlen($_quote)); goto LjWEgWqgkEYt; Z0eqMvFMvjBQ: KnGxiEXjDdJ1: goto mz6C2Gy5A754; fWqlCt4XRs2P: RuFTlCKUXSFp: goto Z0ioCyWLu2xf; nXP5wXdA5387: $prefix = "\75\x3f" . $charset . "\x3f\121\77"; goto Dd5JlZ5mwYS4; SgKf3LpdWvl4: $_quote = $matches[1]; goto gcQ1ZLJspbdP; OsxVFTdPjZkW: $quoted = ''; goto rArhWh1HyjPD; gcQ1ZLJspbdP: WP8nkBuiAAZ2: goto Gckj0CUGjR6d; Gckj0CUGjR6d: $quoted .= $prefix . $_quote . $suffix . $this->eol . "\40"; goto wVjAdCbPptWn; wrgAhO9l7zoo: goto JAyVQmSYIwy0; goto XyIZeYYXmvdh; ccP_LbVf2R7t: $suffix = "\77\x3d"; goto CMhbmoMYKNGy; Dd5JlZ5mwYS4: $suffix = "\x3f\75"; goto Ld9_M2WTS7OW; An31fpZJBI9D: $value = $this->encodeQP($value); goto nXP5wXdA5387; J_UYcm_yL5XP: $value = substr($value, $real_len); goto Jwdlpzqs29RE; Ld9_M2WTS7OW: $add_len = strlen($prefix . $suffix) + strlen($name) + 6; goto MMtuoV_HqF03; tEJ1fK1dyR_Z: goto KnGxiEXjDdJ1; goto LKPIYlBwG1hZ; z2XbfKgh_noj: $prefix = "\75\77" . $charset . "\77\x42\77"; goto ccP_LbVf2R7t; Jwdlpzqs29RE: $quoted .= $prefix . $_quote . $suffix . $this->eol . "\40"; goto P7MlVFztJMN8; bRSm3_745RVq: $real_len = floor(($maxLength - $add_len) / 4) * 4; goto OT85C90QaiMD; P7MlVFztJMN8: $add_len = strlen($prefix . $suffix) + 4; goto D4Q_JpLbWdHp; CMhbmoMYKNGy: $add_len = strlen($prefix . $suffix) + strlen($name) + 6; goto hFducl1J7NQC; D4Q_JpLbWdHp: $len = strlen($value) + $add_len; goto wrgAhO9l7zoo; X_mMCWde81sJ: JAyVQmSYIwy0: goto Otr1ZRtduP8l; LjWEgWqgkEYt: $add_len = strlen($prefix . $suffix) + 4; goto AXxdiQ1B1Hd1; MMtuoV_HqF03: $len = $add_len + strlen($value); goto skQZToT9nXQY; Z0ioCyWLu2xf: $quoted .= $prefix . $value . $suffix; goto tEJ1fK1dyR_Z; AXxdiQ1B1Hd1: $len = strlen($value) + $add_len; goto dOYtKGy06rXf; skQZToT9nXQY: iPz0hfZCxctG: goto AHLsnmbvW_pR; O1cKkatZms7P: $length = $maxLength - $add_len; goto Vbd7Lv8Fi9r1; tA7z0SC3gMS7: $value = base64_encode($value); goto z2XbfKgh_noj; dOYtKGy06rXf: goto iPz0hfZCxctG; goto fWqlCt4XRs2P; OT85C90QaiMD: $_quote = substr($value, 0, $real_len); goto J_UYcm_yL5XP; AHLsnmbvW_pR: if (!($len > $maxLength)) { goto RuFTlCKUXSFp; } goto O1cKkatZms7P; hFducl1J7NQC: $len = $add_len + strlen($value); goto X_mMCWde81sJ; rArhWh1HyjPD: if ($encoding == "\x62\x61\163\145\66\64") { goto WwVtdeP2vnTe; } goto An31fpZJBI9D; mz6C2Gy5A754: return "\40{$name}\x3d\42{$quoted}\42"; goto fq_LtvCNVk2T; fq_LtvCNVk2T: } protected static function mbstringCharset($charset) { goto uf0D5KfGMsRd; MAWK9TRlEwvx: if (!($charset == "\x49\x53\x4f\x2d\x32\60\62\x32\x2d\x4a\120")) { goto h7JD5K10qmrI; } goto uRdNmxf50BTQ; sNOj3bXkzuZU: h7JD5K10qmrI: goto OvMFMRwCzsj7; uRdNmxf50BTQ: $mb_charset = "\111\123\x4f\x2d\62\x30\x32\62\55\112\x50\55\x4d\123"; goto sNOj3bXkzuZU; uf0D5KfGMsRd: $mb_charset = $charset; goto MAWK9TRlEwvx; OvMFMRwCzsj7: return $mb_charset; goto d51B2yugqQNa; d51B2yugqQNa: } public static function encodeHeader($name, $value, $charset = "\x49\x53\117\55\70\70\x35\71\55\61", $encoding = "\161\x75\157\x74\x65\144\x2d\160\162\x69\x6e\164\141\142\154\145", $eol = "\15\12") { goto yLLNCV12Q2aY; h48Y3WWak3DD: HTjNxzbGCW0f: goto izlYYGiDfTTd; CBjZNMrWfzeU: if (in_array($name, $comma_headers)) { goto Su_TP5sK41_e; } goto QyKEn1JsxSTO; BP7Uptm9lCR9: R4qMc6ycmE3f: goto jY_bq1B_6NoZ; GtG5ZZD8Nz2X: $tmp = wordwrap($name . "\x3a\40" . $value, 78, $eol . "\x20"); goto HjR0tEbrZYo4; Hb0Ve0ZAAVMp: if (preg_match("\43\x28\133\x5e\x5c\163\134\x78\x32\61\55\x5c\170\67\105\135\x29\x7b\61\x7d\x23", $value)) { goto mPmJkZeukgE8; } goto X7MhiIzsMtSq; dyQdRzeip3fz: $mb = $charset != "\125\124\106\55\70" && function_exists("\x6d\x62\x5f\x63\157\x6e\166\145\162\x74\137\x65\156\x63\x6f\x64\151\156\147"); goto zjUt3ICdq0zf; xcF2cGZpZHja: if (!empty($separator)) { goto m7JgRWBkLOKv; } goto Hb0Ve0ZAAVMp; yLLNCV12Q2aY: $comma_headers = array("\146\x72\x6f\155", "\x74\x6f", "\x63\143", "\x62\x63\x63", "\163\x65\156\144\x65\162", "\162\x65\160\x6c\171\55\164\x6f", "\162\x65\163\x65\156\164\x2d\146\x72\x6f\x6d", "\x72\145\163\145\156\x74\55\x74\157", "\162\145\163\x65\x6e\164\x2d\143\x63", "\162\145\x73\145\x6e\164\x2d\142\143\143", "\162\145\x73\145\156\164\x2d\x73\145\x6e\144\x65\x72", "\x72\x65\x73\x65\156\164\x2d\x72\x65\160\x6c\x79\x2d\x74\157", "\155\x61\151\x6c\x2d\x72\x65\160\x6c\171\x2d\x74\x6f", "\x6d\141\151\154\55\146\157\154\x6c\157\x77\165\x70\55\x74\157", "\x72\x65\x74\x75\x72\x6e\55\162\145\x63\145\151\x70\x74\x2d\x74\x6f", "\x64\151\x73\x70\157\163\151\164\151\157\x6e\x2d\156\157\164\151\146\x69\143\141\x74\x69\157\x6e\x2d\164\157"); goto bhOS9xPe3YR3; llBCYBptZUsQ: Su_TP5sK41_e: goto q_RwTUu20Mkk; CLV83jvMZk6m: $name = strtolower($name); goto CBjZNMrWfzeU; j4fiCBl1i5XQ: $value = Mail_mimePart::encodeHeaderValue($value, $charset, $encoding, strlen($name) + 2, $eol); goto CGwFJgqEGmWa; qnK3b8JnkruI: if (!$mb) { goto CEXBOnlezKWH; } goto sZNJ_y9zyddp; QyKEn1JsxSTO: if (!in_array($name, $other_headers)) { goto gYlFTWTOrO7O; } goto FPpEvK90BYRX; hX8WYmbHLg62: mPmJkZeukgE8: goto WWGdpbzZ3ovu; QiaSrNE1mIdM: if (!$mb) { goto ii0hUO7CBvMW; } goto eb23E25GyIoS; HMbmEuYbeFL_: $charset = "\111\x53\x4f\55\x38\x38\65\x39\55\x31"; goto gIaKm0tjZEm2; X7MhiIzsMtSq: if (!(strlen($name . "\x3a\x20" . $value) > 78)) { goto OrhAO3Uidcnr; } goto qDZlggx_D7GZ; FPpEvK90BYRX: $separator = "\x20"; goto me7ZVPFP1jz_; szO7cgqtE8ws: $value = preg_replace("\57\x5e" . $name . "\72\x28" . preg_quote($eol, "\x2f") . "\x29\52\x20\57", '', $value); goto jmqk89fRtXM9; q_RwTUu20Mkk: $separator = "\x2c"; goto BP7Uptm9lCR9; HjR0tEbrZYo4: $value = preg_replace("\57\x5e" . $name . "\72\x5c\163\x2a\x2f", '', $tmp); goto oBJ1PZ0741y0; CGwFJgqEGmWa: gKrWToD45oma: goto I1UyXot6B70S; oBJ1PZ0741y0: $value = wordwrap($value, 998, $eol . "\x20", true); goto fM90bm7C8n6S; eb23E25GyIoS: $value = mb_convert_encoding($value, $mb_charset, "\x55\124\x46\x2d\x38"); goto o8vYKOv6E1Tg; wI_ouhxpcfZV: $value = preg_replace("\57\134\x5c\50\x5b\134\134\x22\135\51\57", "\x24\x31", $value); goto QiaSrNE1mIdM; s7sXSRDRnPdY: jhc3rR9qFzGc: goto j4fiCBl1i5XQ; jmqk89fRtXM9: d4X_9ih0mvef: goto qWSmQWlmyEkW; me7ZVPFP1jz_: gYlFTWTOrO7O: goto cLkg3WiauxnB; qWSmQWlmyEkW: return $value; goto zyZW31_RiBCq; uQyF_vORSObB: $value = substr($value, 1, -1); goto wI_ouhxpcfZV; izlYYGiDfTTd: $parts = Mail_mimePart::explodeQuotedString("\133\x9{$separator}\x5d", $value); goto CwehN107jya6; gZuCz_qst3h2: if (!$mb) { goto HTjNxzbGCW0f; } goto JEtnzbaSSwlI; WWGdpbzZ3ovu: if (!($value[0] == "\x22" && $value[strlen($value) - 1] == "\42")) { goto jhc3rR9qFzGc; } goto qnK3b8JnkruI; cLkg3WiauxnB: goto R4qMc6ycmE3f; goto llBCYBptZUsQ; zjUt3ICdq0zf: $mb_charset = Mail_mimePart::mbstringCharset($charset); goto xcF2cGZpZHja; gIaKm0tjZEm2: EcstwtRNjzpo: goto dyQdRzeip3fz; jY_bq1B_6NoZ: if ($charset) { goto EcstwtRNjzpo; } goto HMbmEuYbeFL_; oLRZzSiwOLwb: m7JgRWBkLOKv: goto GKYmcZ3mX2D5; qDZlggx_D7GZ: $value = preg_replace("\x2f\134\162\77\x5c\x6e\x5b\x5c\x73\x5c\164\x5d\x2a\57", $eol . "\x20", $value); goto GtG5ZZD8Nz2X; I1UyXot6B70S: goto d4X_9ih0mvef; goto oLRZzSiwOLwb; SuJcC76ZGJ78: UkSmNmW2tmkA: goto szO7cgqtE8ws; mrlN0KUDMRR7: foreach ($parts as $part) { goto ixJNbMnmm7Fm; wtG612zoW6OK: if (($pos = strrpos($value, $eol)) !== false) { goto MghUYyOtO2V2; } goto ILHpW9jgI8uO; O7tt94TBStBr: tgHpE2p3hz5z: goto dQLMVW3JyKcX; sQSVzPhWzf68: Y1fV1J39VcoC: goto qbNHiT0Pp84X; wOfoaJBk00CL: jomyTsvoFEin: goto mDDY8rBkt4UO; h0Zv4EeNtPMd: $word = trim($word); goto VrwMiZru11J9; mDDY8rBkt4UO: $address = $matches[0]; goto xBCSf_VB_BxF; sGsVAZQcjRal: if (!$mb) { goto q7juO0tTkIXU; } goto Jpj6yzX68PKZ; rgGgCIS_pVnE: goto X6XilP8stfbG; goto wOfoaJBk00CL; hX7kLzGXNqAD: if (preg_match("\x23\50\x5b\136\134\163\x5c\170\62\61\55\134\x78\x37\x45\135\x29\173\x31\x7d\43", $word)) { goto jwuWzVzLiaH4; } goto gnytDsZ3yBU2; qbNHiT0Pp84X: $value .= $separator == "\x2c" ? $separator . "\x20" : "\40"; goto lpNEfcAfdtOk; NgEM4UwpA7TK: $part = trim($part); goto YcC3DWxNUh4D; RKJYvXNTkUJK: goto RmJ3ZbT1EPpb; goto XohknyupanHN; lpNEfcAfdtOk: QYsOKMABChGD: goto QRtAYUFjaVdZ; Td3SlByXnaWt: LaPW5m_4Gq3m: goto pLkfkGdbFHlx; wI5KqbeFVhqt: $value .= $part; goto jdSXS4_pEJD8; frl4mtmxdt40: $word = substr($word, 1, -1); goto NtFtpKPWnYNd; B0xMTfd816kB: $value .= $word . "\40" . $address; goto WocWrmtIqjPA; WocWrmtIqjPA: X6XilP8stfbG: goto mVI5P4rlY4Qk; ixJNbMnmm7Fm: $part = preg_replace("\57\x5c\162\77\134\x6e\133\134\163\134\x74\135\x2a\57", $eol . "\40", $part); goto NgEM4UwpA7TK; i1p2B7jRD_u9: UfiQL23DD3wV: goto wI5KqbeFVhqt; pLkfkGdbFHlx: $value .= $part; goto rgGgCIS_pVnE; XohknyupanHN: MghUYyOtO2V2: goto faow31VB65oq; NtFtpKPWnYNd: $word = preg_replace("\57\134\134\50\x5b\134\134\x22\135\x29\57", "\x24\61", $word); goto tZDbZ3dOLm7T; xtwa33epX15Z: kOLtzdoQKu44: goto g661C_8f2nnp; z0p4KV6GVMBT: RZgLC6vkyu90: goto U42m2b_SrvNH; ozc_HM2_svgQ: q7juO0tTkIXU: goto wtG612zoW6OK; VrwMiZru11J9: if (!$word) { goto iv4R9e1c16hh; } goto hX7kLzGXNqAD; jdSXS4_pEJD8: AZXwH6Ly7Nks: goto x31bYWvg3pr1; zwExZy3bTt7w: $word = "\x22" . addcslashes($word, "\x5c\x22") . "\42"; goto XRsMGZim7FBU; rm_HAqUUWyPO: if (!($word[0] == "\42" && $word[strlen($word) - 1] == "\42")) { goto ifbFxUbYIVHU; } goto frl4mtmxdt40; x31bYWvg3pr1: $value = wordwrap($value, 76, $eol . "\40"); goto xtwa33epX15Z; QRtAYUFjaVdZ: if (preg_match("\57\x5e\x3c" . $email_regexp . "\76\x24\x2f", $part)) { goto UfiQL23DD3wV; } goto haUqDaO_hKD3; mVI5P4rlY4Qk: goto iX795dY07GMM; goto O7tt94TBStBr; YcC3DWxNUh4D: if ($part) { goto DNCxmO3pstaN; } goto EJCsaIgZNWcT; rY98OVJT2Um8: $value = $name . "\72\40"; goto WzMFU9ghP3pL; gnytDsZ3yBU2: if (!(($word[0] != "\42" || $word[strlen($word) - 1] != "\x22") && preg_match("\57\133\x5c\50\x5c\51\x5c\x3c\x5c\76\x5c\134\56\x5c\x5b\134\x5d\100\x2c\x3b\72\42\135\x2f", $word))) { goto AEYugS9AS3ql; } goto zwExZy3bTt7w; KEXvBWk2YnBR: jwuWzVzLiaH4: goto rm_HAqUUWyPO; EZchEdOnMhAd: DNCxmO3pstaN: goto ycLapZULkkRw; e02bN7Fs79lq: $word = Mail_mimePart::encodeHeaderValue($word, $charset, $encoding, $last_len, $eol); goto z0p4KV6GVMBT; fUl3rx0ThAqL: $part = mb_convert_encoding($part, $mb_charset, "\x55\x54\x46\55\x38"); goto Td3SlByXnaWt; EJCsaIgZNWcT: goto kOLtzdoQKu44; goto EZchEdOnMhAd; haUqDaO_hKD3: if (preg_match("\x2f\136" . $email_regexp . "\x24\x2f", $part)) { goto tgHpE2p3hz5z; } goto l1m6bKkRa45M; ILHpW9jgI8uO: $last_len = strlen($value); goto RKJYvXNTkUJK; NjGS0CsawOOT: if (!$mb) { goto LaPW5m_4Gq3m; } goto fUl3rx0ThAqL; tZDbZ3dOLm7T: ifbFxUbYIVHU: goto sGsVAZQcjRal; U42m2b_SrvNH: iv4R9e1c16hh: goto B0xMTfd816kB; XRsMGZim7FBU: AEYugS9AS3ql: goto CM4dM2155xuy; H2YQoU87kCuV: RmJ3ZbT1EPpb: goto e02bN7Fs79lq; i401yz3wqZEU: goto AZXwH6Ly7Nks; goto i1p2B7jRD_u9; ycLapZULkkRw: if ($value) { goto Y1fV1J39VcoC; } goto rY98OVJT2Um8; WzMFU9ghP3pL: goto QYsOKMABChGD; goto sQSVzPhWzf68; faow31VB65oq: $last_len = strlen($value) - $pos; goto H2YQoU87kCuV; l1m6bKkRa45M: if (preg_match("\57\74\52" . $email_regexp . "\x3e\x2a\44\x2f", $part, $matches)) { goto jomyTsvoFEin; } goto NjGS0CsawOOT; CM4dM2155xuy: goto RZgLC6vkyu90; goto KEXvBWk2YnBR; dQLMVW3JyKcX: $value .= $part; goto OuXJSy3vAQQx; Jpj6yzX68PKZ: $word = mb_convert_encoding($word, $mb_charset, "\x55\124\106\x2d\70"); goto ozc_HM2_svgQ; xBCSf_VB_BxF: $word = str_replace($address, '', $part); goto h0Zv4EeNtPMd; OuXJSy3vAQQx: iX795dY07GMM: goto i401yz3wqZEU; g661C_8f2nnp: } goto SuJcC76ZGJ78; GKYmcZ3mX2D5: $email_regexp = "\x28\x5b\x5e\x5c\x73\74\x5d\x2b\x7c\50\42\133\x5e\x5c\x72\x5c\x6e\42\x5d\x2b\42\51\51\100\134\x53\x2b"; goto gZuCz_qst3h2; CwehN107jya6: $value = ''; goto mrlN0KUDMRR7; fM90bm7C8n6S: OrhAO3Uidcnr: goto qwObAqplIBs8; sZNJ_y9zyddp: $value = mb_convert_encoding($value, "\125\x54\x46\55\70", $mb_charset); goto Er8_7ifaD8jH; qwObAqplIBs8: goto gKrWToD45oma; goto hX8WYmbHLg62; Er8_7ifaD8jH: CEXBOnlezKWH: goto uQyF_vORSObB; bhOS9xPe3YR3: $other_headers = array("\162\x65\146\145\162\145\x6e\x63\145\x73", "\x69\x6e\x2d\x72\x65\x70\x6c\171\55\164\x6f", "\155\145\x73\x73\x61\x67\145\55\151\144", "\x72\x65\163\x65\156\164\x2d\x6d\145\x73\163\x61\147\x65\55\151\x64"); goto CLV83jvMZk6m; o8vYKOv6E1Tg: ii0hUO7CBvMW: goto s7sXSRDRnPdY; JEtnzbaSSwlI: $value = mb_convert_encoding($value, "\x55\124\106\55\70", $mb_charset); goto h48Y3WWak3DD; zyZW31_RiBCq: } protected static function explodeQuotedString($delimiter, $string) { goto E7jNZJ7P5aif; o3KBn82Kt61B: rlHWnsGuQdRs: goto q4RNYViPRe96; o8DGvlarR4Jp: DIWPiJXdSgH_: goto iRUwgRkKmEO5; La8i6CVdSzih: goto rlHWnsGuQdRs; goto FXMiNIHRzhFs; E7jNZJ7P5aif: $result = array(); goto dx9UA5TBfI13; tO7jMh6pifGI: Gt6uQe2gqwgv: goto Ul4jix79k10I; Oj3uKPY3qOYJ: XMoECJdp51fA: goto ZmJv17WZD3Kg; vdok1C7W09U_: $quoted_string = "\x22\x28\x3f\72\x5b\136\x22\134\x5c\135\x7c\134\134\x2e\51\52\x22"; goto zv870O3Gbh3b; FXMiNIHRzhFs: QM2xN1OScopf: goto uuQm9I8SqTzI; uuQm9I8SqTzI: $i += strlen($matches[0]) - 1; goto Po1QTsvhRjE3; sW9aQ24DIWI9: $p = $i + 1; goto tO7jMh6pifGI; knZ1ECtuHPKn: return $result; goto UzZuYi0Vxpmu; Po1QTsvhRjE3: qUHwOI0dj8yK: goto Pl_SfHNbAS6M; Pl_SfHNbAS6M: LNCnftpZ1roU: goto pok5jiJ8NbAA; Am9ycSLpRTHM: if ($string[$i] === "\x22") { goto DIWPiJXdSgH_; } goto nO_Qox1hgUpd; ENvimdoE4H98: if (!(!$r || empty($matches[0]))) { goto QM2xN1OScopf; } goto La8i6CVdSzih; dx9UA5TBfI13: $strlen = strlen($string); goto vdok1C7W09U_; PEcAI79TIU8F: goto XMoECJdp51fA; goto o3KBn82Kt61B; Ul4jix79k10I: goto qUHwOI0dj8yK; goto o8DGvlarR4Jp; ZmJv17WZD3Kg: if (!($i < $strlen)) { goto rlHWnsGuQdRs; } goto Am9ycSLpRTHM; nO_Qox1hgUpd: if (!preg_match("\57{$delimiter}\x2f", $string[$i])) { goto Gt6uQe2gqwgv; } goto sOu6kTgiJroh; pok5jiJ8NbAA: $i++; goto PEcAI79TIU8F; q4RNYViPRe96: $result[] = substr($string, $p); goto knZ1ECtuHPKn; sOu6kTgiJroh: $result[] = substr($string, $p, $i - $p); goto sW9aQ24DIWI9; iRUwgRkKmEO5: $r = preg_match("\57{$quoted_string}\57", $string, $matches, 0, $i); goto ENvimdoE4H98; zv870O3Gbh3b: $p = $i = 0; goto Oj3uKPY3qOYJ; UzZuYi0Vxpmu: } public static function encodeHeaderValue($value, $charset, $encoding, $prefix_len = 0, $eol = "\15\12") { goto CYRzNgqBzzbT; CYRzNgqBzzbT: if (!($result = Mail_mimePart::encodeMB($value, $charset, $encoding, $prefix_len, $eol))) { goto gPH8DCb3cdhA; } goto s15NOvXnFhNy; JJNLJc4cL6E8: $value = $output; goto EEPL2ErTBMPN; Ymb1aXP8vBWc: goto CCz1NJa87HwA; goto f7_KNhWQljAz; UyjOUB2xLv1f: $maxLength1stLine = $maxLength1stLine - $maxLength1stLine % 4; goto ySFqRISv18Y9; GJHNKVFoednx: $part = substr($value, 0, $cutpoint); goto U8sklR5T_giF; bhM_PfdmZVuT: $output .= $prefix . $part . $suffix; goto Ymb1aXP8vBWc; f7_KNhWQljAz: YQ2zlGinqzOp: goto SunF6dgvco2F; nrE3Kx81DPU0: z40pZqnbmXEU: goto bWKBikLqq48E; vreurAAcl8h2: jSqG29vpEDkU: goto q02cwt_rdX3j; GaT5b87pG1z_: hN6UbJHvnTdF: goto qhbHs3BLsoUP; kNBEG58FNZev: goto ouYtz4K4R132; goto Z2KNLkc4k6xa; lJ0cnrpnN3rW: $encoding = $encoding == "\x62\141\x73\x65\x36\64" ? "\102" : "\121"; goto CP4ylmR_rpqm; KPIgfs8qA_Am: $output = ''; goto EGehujnxOeYp; sHnrLzG3f6e4: if (strlen($value) > $maxLength1stLine) { goto jSqG29vpEDkU; } goto rryVqHh7JBuH; RgKD3dhDr5ro: $output = ''; goto IjBSaa1S8L2s; qmLj6JHu4NBt: return $value; goto D1UO4Nu06UVd; uQTjvDuDC_z6: $part = $value; goto mAy2lpK7DxIL; cMq84BjFY2lf: $found = preg_match($reg, $value, $matches); goto K2vF0LXNRn3G; Y4gVYQj9DcS1: if (!$value) { goto d8O1a094LmRX; } goto cMq84BjFY2lf; rryVqHh7JBuH: $value = $prefix . $value . $suffix; goto HfvV20jzJd0i; s15NOvXnFhNy: return $result; goto dQDfbG4pV7R5; CP4ylmR_rpqm: $prefix = "\75\x3f" . $charset . "\77" . $encoding . "\x3f"; goto dW28QEfh7b_u; pRVMM5kjD0PB: $value = substr($value, $len); goto GaT5b87pG1z_; OZLCUh3qBjEc: if (!$output) { goto wAghfhW__sFe; } goto mLPd7gYoSEzX; Ymfa7ErU2zL7: $value = Mail_mimePart::encodeQP($value); goto RxCAbe9e9oIC; efLpInxg5NY4: ARfRKYgEmbZB: goto ulrTqeHqJ_ZN; OeGr71RFBFtY: $maxLength1stLine = $maxLength - $prefix_len; goto VV3nt7Ae6o3A; ywPJsTEtyBry: $maxLength = 75 - strlen($prefix . $suffix); goto OeGr71RFBFtY; JejecW6HYWYD: $reg2nd = "\x7c\x28\x2e\x7b\x30\54{$maxLength}\175\x5b\x5e\134\x3d\135\x5b\136\x5c\x3d\135\x29\174"; goto sHnrLzG3f6e4; nTzjS24l_Ksa: if ($found) { goto z40pZqnbmXEU; } goto uQTjvDuDC_z6; ySFqRISv18Y9: $cutpoint = $maxLength1stLine; goto KPIgfs8qA_Am; DpjJJjqo0ZJM: goto hN6UbJHvnTdF; goto nrE3Kx81DPU0; BU2WKPknQIjN: goto xiwFbK9uIolB; goto efLpInxg5NY4; q02cwt_rdX3j: $reg = $reg1st; goto RgKD3dhDr5ro; SunF6dgvco2F: $value = $output; goto ksWMGevi5Kt4; dQDfbG4pV7R5: gPH8DCb3cdhA: goto lJ0cnrpnN3rW; IjBSaa1S8L2s: ouYtz4K4R132: goto Y4gVYQj9DcS1; EEPL2ErTBMPN: mOpch_I_p4ta: goto BU2WKPknQIjN; U9GWptkDe8dl: $len = strlen($matches[0]); goto pRVMM5kjD0PB; VV3nt7Ae6o3A: if ($encoding == "\x42") { goto ARfRKYgEmbZB; } goto Ymfa7ErU2zL7; RxCAbe9e9oIC: $reg1st = "\x7c\50\56\173\x30\x2c{$maxLength1stLine}\x7d\133\x5e\134\x3d\x5d\x5b\136\x5c\75\x5d\x29\x7c"; goto JejecW6HYWYD; dW28QEfh7b_u: $suffix = "\x3f\x3d"; goto ywPJsTEtyBry; K2vF0LXNRn3G: $reg = $reg2nd; goto nTzjS24l_Ksa; mAy2lpK7DxIL: $value = ''; goto DpjJJjqo0ZJM; PnmtwIcuGAwe: $cutpoint = $maxLength; goto OZLCUh3qBjEc; HfvV20jzJd0i: goto mOpch_I_p4ta; goto vreurAAcl8h2; q7MONvgqHIO1: $maxLength = $maxLength - $maxLength % 4; goto UyjOUB2xLv1f; ITz4nt53Dhjg: b6NOUgc83Buq: goto JhnMFMF5wCpJ; qhbHs3BLsoUP: if (!$output) { goto b6NOUgc83Buq; } goto QA9dHx2Z86un; ulrTqeHqJ_ZN: $value = base64_encode($value); goto q7MONvgqHIO1; QA9dHx2Z86un: $output .= $eol . "\x20"; goto ITz4nt53Dhjg; dgCw69EwlW0T: wAghfhW__sFe: goto bhM_PfdmZVuT; Z2KNLkc4k6xa: d8O1a094LmRX: goto JJNLJc4cL6E8; JhnMFMF5wCpJ: $output .= $prefix . $part . $suffix; goto kNBEG58FNZev; mLPd7gYoSEzX: $output .= $eol . "\40"; goto dgCw69EwlW0T; EGehujnxOeYp: CCz1NJa87HwA: goto Grq5fVF7QvbZ; Grq5fVF7QvbZ: if (!$value) { goto YQ2zlGinqzOp; } goto GJHNKVFoednx; ksWMGevi5Kt4: xiwFbK9uIolB: goto qmLj6JHu4NBt; bWKBikLqq48E: $part = $matches[0]; goto U9GWptkDe8dl; U8sklR5T_giF: $value = substr($value, $cutpoint); goto PnmtwIcuGAwe; D1UO4Nu06UVd: } public static function encodeQP($str) { goto ZgAfUyyMEUx3; EFOwh61X0U0q: return str_replace("\40", "\x5f", $str); goto BBxm2HIphc50; s6FWc1E8AHBu: $str = preg_replace_callback($regexp, array("\x4d\141\x69\154\x5f\x6d\151\155\145\120\x61\162\164", "\161\x70\122\x65\x70\154\141\143\x65\x43\141\154\154\142\141\x63\153"), $str); goto EFOwh61X0U0q; ZgAfUyyMEUx3: $regexp = "\x2f\x28\x5b\134\x78\x32\x32\x2d\134\x78\x32\71\134\170\x32\103\134\170\x32\x45\134\170\x33\x41\55\x5c\x78\64\x30\x5c\x78\x35\x42\55\134\x78\66\x30\134\170\67\x42\55\x5c\x78\67\x45\134\x78\70\60\55\x5c\x78\x46\x46\x5d\51\x2f"; goto s6FWc1E8AHBu; BBxm2HIphc50: } public static function encodeMB($str, $charset, $encoding, $prefix_len = 0, $eol = "\15\12") { goto EvBzv0r5DMlD; g4Rggb7A3ECR: $line_length = 0; goto VMfH3_ZmExA9; c9R4IaV332SY: NyG02IEr5bPl: goto UOgocsfVUMUO; UOgocsfVUMUO: return $result; goto avtxPixxHKq7; ml1fMo6NtDvi: if (!$result) { goto e9spLhr37Vxz; } goto O6CpGs6R13jq; aGpjZqHQafHE: S4n001V5Z5EM: goto qP4BxyBoELCS; aXy8RE9R6GmM: $char = mb_substr($str, $i, 1, $mb_charset); goto SQemIrCoBAjn; LcZXsF9YoLGb: if ($line_length + $chunk_len > $maxLength) { goto XinpqUrAiUuj; } goto JkeebGQZKmfq; oBUbHnolDmaA: $result = $prefix . str_replace("\xa", $suffix . $eol . "\40" . $prefix, $result) . $suffix; goto c9R4IaV332SY; T1wYzZhHVqYu: $suffix = "\x3f\75"; goto Ktpiw_iuDzIL; JkeebGQZKmfq: $prev = $chunk; goto MN_JzOiC99af; O_jAHXbiKJPx: $i++; goto kcOSc8m7egPH; ar1SO0a2Rl6p: $result = ''; goto Aio1yKGfwiw6; lbPHyvko50i4: $chunk_len = strlen($chunk); goto B9cdLBLOtvG3; kcOSc8m7egPH: goto Op4w1mwFsAh2; goto gLL3irZjwRXO; ePNA_YXERAet: XinpqUrAiUuj: goto ml1fMo6NtDvi; jGeUluqoLj1e: $regexp = "\57\x28\x5b\134\x78\62\62\x2d\134\170\x32\71\134\x78\62\103\134\170\62\105\x5c\170\x33\x41\x2d\x5c\x78\64\60\134\x78\65\x42\55\x5c\170\66\60\134\170\67\102\x2d\x5c\x78\x37\105\x5c\x78\x38\60\55\134\170\106\x46\135\51\57"; goto YM9QuiZop3Ex; wjpKnYBqL53b: $result .= "\12"; goto r4Jq3kdPn4Vl; DSzgA42wFofa: $line_length = 0; goto nN8VARoR9w6s; nN8VARoR9w6s: $start = $i - 1; goto bmktnOxvVJe7; o1ZaD_4MkWkK: return; goto Tb4RadOoF01M; r4Jq3kdPn4Vl: jVqwpEWPtunK: goto hNdvg8kecrhq; O6CpGs6R13jq: $result .= "\12"; goto DDQnNTU3VlWV; j7V2sfBC7lA7: $i = 1; goto waLSbqQJ6qgh; DIzq5jbJSLMX: sSfKi_eypQd7: goto ETYzff1EKxRG; Ktpiw_iuDzIL: $maxLength = 75 - strlen($prefix . $suffix); goto jjp9hd46L1vZ; tBTXD8owf_5g: $char = "\x5f"; goto tVxOAyVWV1J1; ZH_xf9w1wNrI: $char_len = strlen($char); goto ZQlhfq_FmqqY; hNdvg8kecrhq: $result .= $chunk; goto g4Rggb7A3ECR; ZYIV43xgGAJP: JFI7r633BcEH: goto HlhRJbHm5tc8; YM9QuiZop3Ex: $i = 0; goto nSfyGRNUpYmS; lbc6y84gRCC3: fMvGSH8sUWWm: goto tBTXD8owf_5g; YIlQOw8uMoSo: $length = mb_strlen($str, $mb_charset); goto ar1SO0a2Rl6p; DY8zS5YOZtKU: $encoding = $encoding == "\x62\141\x73\x65\66\x34" ? "\102" : "\121"; goto HRV8lm05VT38; gLL3irZjwRXO: xa4fbMaqLzqN: goto NgXEUQbFV16l; zMcxYScF6N32: $chunk = mb_substr($str, $start, $i - $start, $mb_charset); goto hovDIzEd1io0; uV8P7v9kEeA0: WEOKua9nloB3: goto p4XWa3xnkNp4; YyxtwwIEtev5: $result .= $prev; goto Z2nPZOKrKgvZ; B9cdLBLOtvG3: if ($line_length + $chunk_len == $maxLength || $i == $length) { goto WEOKua9nloB3; } goto LcZXsF9YoLGb; wQ5fAX3vrYaE: goto BFzlzxqiZQVo; goto Z1djx5xiUP6H; FH8v9Y6f71hY: $result .= "\12"; goto BtZ02p67tEcZ; ETYzff1EKxRG: $result .= $char; goto AeRdS15A_r51; AeRdS15A_r51: $line_length += $char_len; goto Wc5CtSUfw1KB; wIK91XPNNr2S: goto JFI7r633BcEH; goto uV8P7v9kEeA0; Wc5CtSUfw1KB: A0aav25fiEb0: goto zeErtFLylbiF; KqsHqvAliXg2: QF882jE3DbEM: goto wQ5fAX3vrYaE; hovDIzEd1io0: $chunk = base64_encode($chunk); goto lbPHyvko50i4; BtZ02p67tEcZ: EaVv3wHXC81F: goto NA9BUAWPFAEr; NgXEUQbFV16l: BFzlzxqiZQVo: goto AFjTXUzpVO9w; zeErtFLylbiF: $i++; goto Qun2Zctwilcp; SQemIrCoBAjn: if ($char == "\40") { goto fMvGSH8sUWWm; } goto kAxUQjMyXH0G; kAxUQjMyXH0G: $char = preg_replace_callback($regexp, array("\115\x61\151\x6c\137\x6d\151\155\x65\120\141\x72\164", "\x71\x70\x52\x65\160\154\x61\x63\145\103\141\154\154\142\141\x63\x6b"), $char); goto ZH_xf9w1wNrI; Aio1yKGfwiw6: $line_length = $prefix_len; goto HAosWDRjAjbl; VMfH3_ZmExA9: $start = $i; goto ZYIV43xgGAJP; bmktnOxvVJe7: CkPKxyQR70JQ: goto wIK91XPNNr2S; p4XWa3xnkNp4: if (!$result) { goto jVqwpEWPtunK; } goto wjpKnYBqL53b; MN_JzOiC99af: goto CkPKxyQR70JQ; goto ePNA_YXERAet; jjp9hd46L1vZ: $mb_charset = Mail_mimePart::mbstringCharset($charset); goto YIlQOw8uMoSo; NA9BUAWPFAEr: $line_length = 0; goto DIzq5jbJSLMX; Z2nPZOKrKgvZ: GTFOdQ99RDJS: goto DSzgA42wFofa; Tb4RadOoF01M: OnaHiqMao3fm: goto DY8zS5YOZtKU; AFjTXUzpVO9w: if (!$result) { goto NyG02IEr5bPl; } goto oBUbHnolDmaA; nSfyGRNUpYmS: i823RoFqaPON: goto KlJOrbXM2gIu; yruicEW_bX1_: if (!$result) { goto EaVv3wHXC81F; } goto FH8v9Y6f71hY; waLSbqQJ6qgh: Op4w1mwFsAh2: goto a9g7Ldff_NdS; HlhRJbHm5tc8: iGiLy0bbC8m2: goto O_jAHXbiKJPx; LCc1GQVsiStQ: $prev = ''; goto j7V2sfBC7lA7; HRV8lm05VT38: $prefix = "\x3d\77" . $charset . "\x3f" . $encoding . "\x3f"; goto T1wYzZhHVqYu; ZQlhfq_FmqqY: goto S4n001V5Z5EM; goto lbc6y84gRCC3; Z1djx5xiUP6H: lcU31pLEtbiA: goto ElCy98enMMLo; qP4BxyBoELCS: if (!($line_length + $char_len > $maxLength)) { goto sSfKi_eypQd7; } goto yruicEW_bX1_; EvBzv0r5DMlD: if (!(!function_exists("\x6d\142\x5f\x73\165\142\163\x74\x72") || !function_exists("\x6d\x62\137\x73\164\162\154\145\x6e"))) { goto OnaHiqMao3fm; } goto o1ZaD_4MkWkK; HAosWDRjAjbl: if ($encoding == "\102") { goto lcU31pLEtbiA; } goto jGeUluqoLj1e; DDQnNTU3VlWV: e9spLhr37Vxz: goto SyFDb658YfnR; ElCy98enMMLo: $start = 0; goto LCc1GQVsiStQ; tVxOAyVWV1J1: $char_len = 1; goto aGpjZqHQafHE; Qun2Zctwilcp: goto i823RoFqaPON; goto KqsHqvAliXg2; a9g7Ldff_NdS: if (!($i <= $length)) { goto xa4fbMaqLzqN; } goto zMcxYScF6N32; SyFDb658YfnR: if (!$prev) { goto GTFOdQ99RDJS; } goto YyxtwwIEtev5; KlJOrbXM2gIu: if (!($i <= $length)) { goto QF882jE3DbEM; } goto aXy8RE9R6GmM; avtxPixxHKq7: } protected static function qpReplaceCallback($matches) { return sprintf("\x3d\45\x30\62\x58", ord($matches[1])); } protected static function encodeReplaceCallback($matches) { return sprintf("\x25\45\x25\60\x32\130", ord($matches[1])); } function raiseError($message) { ZLog::Write(LOGLEVEL_ERROR, "\x6d\151\155\145\x50\141\x72\x74\40\x65\162\162\x6f\x72\72\x20" . $message); return false; } }
